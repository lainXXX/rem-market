25-01-13.14:19:41.470 [main            ] INFO  RebateTest             - Starting RebateTest using Java 1.8.0_151 on mile with PID 8092 (started by aaa in D:\Develop\project\rem-market\market-app)
25-01-13.14:19:41.471 [main            ] INFO  RebateTest             - The following 1 profile is active: "dev"
25-01-13.14:19:42.553 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-01-13.14:19:42.556 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-01-13.14:19:42.619 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 50 ms. Found 0 Redis repository interfaces.
25-01-13.14:19:44.233 [main            ] INFO  Version                - Redisson 3.26.0
25-01-13.14:19:45.048 [redisson-netty-1-6] INFO  ConnectionsHolder      - 1 connections initialized for 110.41.180.185/110.41.180.185:6379
25-01-13.14:19:45.253 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 110.41.180.185/110.41.180.185:6379
25-01-13.14:19:57.350 [main            ] INFO  RebateTest             - Starting RebateTest using Java 1.8.0_151 on mile with PID 19068 (started by aaa in D:\Develop\project\rem-market\market-app)
25-01-13.14:19:57.351 [main            ] INFO  RebateTest             - The following 1 profile is active: "dev"
25-01-13.14:19:58.210 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-01-13.14:19:58.212 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-01-13.14:19:58.270 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 48 ms. Found 0 Redis repository interfaces.
25-01-13.14:19:59.684 [main            ] INFO  Version                - Redisson 3.26.0
25-01-13.14:20:00.440 [redisson-netty-1-6] INFO  ConnectionsHolder      - 1 connections initialized for 110.41.180.185/110.41.180.185:6379
25-01-13.14:20:00.660 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 110.41.180.185/110.41.180.185:6379
25-01-13.14:20:05.682 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-01-13.14:20:05.756 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [110.41.180.185:5672]
25-01-13.14:20:05.939 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#7ed8b44:0/SimpleConnection@7381d6f0 [delegate=amqp://lain@110.41.180.185:5672/, localPort= 50650]
25-01-13.14:20:06.531 [main            ] INFO  RebateTest             - Started RebateTest in 9.605 seconds (JVM running for 10.654)
25-01-13.14:20:06.807 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-01-13.14:20:07.384 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-01-13.14:20:07.953 [main            ] INFO  EventPublisher         - 发送MQ消息 topic: send_rebate message: BaseEvent.EventMessage(eventId=28006157552, timestamp=Mon Jan 13 14:20:07 CST 2025, data=SendRebateMessageEvent.RebateMessage(userId=rem, rebateDesc=签到返利-sku额度, rebateType=sku, rebateConfig=9011, bizId=rem_sku_20250113))
25-01-13.14:20:07.989 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"28006157552","timestamp":"Jan 13, 2025 2:20:07 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_20250113"}}
25-01-13.14:20:08.022 [main            ] INFO  EventPublisher         - 发送MQ消息 topic: send_rebate message: BaseEvent.EventMessage(eventId=76708730339, timestamp=Mon Jan 13 14:20:07 CST 2025, data=SendRebateMessageEvent.RebateMessage(userId=rem, rebateDesc=签到返利-积分, rebateType=integral, rebateConfig=10, bizId=rem_integral_20250113))
25-01-13.14:20:08.219 [main            ] INFO  RebateTest             - 请求参数：{"behaviorType":"SIGN","outBusinessNo":"20250113","userId":"rem"}
25-01-13.14:20:08.222 [main            ] INFO  RebateTest             - 测试结果：["rem_sku_20250113","rem_integral_20250113"]
25-01-13.14:20:08.266 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=20) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.14:20:08.269 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.14:20:08.270 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SkuStockFilterChain    - 执行活动sku库存扣减责任链
25-01-13.14:20:08.439 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - CreateQuotaOrderAggregate(userId=rem, activityId=100301, activityName=null, totalCount=1, monthCount=1, dayCount=1, activityOrder=ActivityOrderEntity(userId=rem, sku=9011, activityId=100301, activityName=测试活动, strategyId=100006, orderId=07699095286, orderTime=2025-01-13T14:20:08.437, totalCount=1, dayCount=1, monthCount=1, status=completed, outBusinessNo=rem_sku_20250113))
25-01-13.14:20:08.704 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"76708730339","timestamp":"Jan 13, 2025 2:20:07 PM","data":{"userId":"rem","rebateDesc":"签到返利-积分","rebateType":"integral","rebateConfig":"10","bizId":"rem_integral_20250113"}}
25-01-13.14:20:08.705 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户行为返利消息 - 非sku奖励暂时不处理 topic: send_rebate message: {"eventId":"76708730339","timestamp":"Jan 13, 2025 2:20:07 PM","data":{"userId":"rem","rebateDesc":"签到返利-积分","rebateType":"integral","rebateConfig":"10","bizId":"rem_integral_20250113"}}
25-01-13.14:20:30.005 [scheduling-1    ] INFO  SendMessageTaskJob     - 发送MQ消息任务开始执行
25-01-13.14:20:30.072 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 活动库存扣减定时任务
25-01-13.14:21:00.015 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 活动库存扣减定时任务
25-01-13.14:21:00.045 [scheduling-1    ] INFO  UpdateAwardStockJob    - 更新奖品库存任务
25-01-13.14:21:00.078 [scheduling-1    ] INFO  SendMessageTaskJob     - 发送MQ消息任务开始执行
25-01-13.14:21:30.013 [scheduling-1    ] INFO  SendMessageTaskJob     - 发送MQ消息任务开始执行
25-01-13.14:21:30.077 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 活动库存扣减定时任务
25-01-13.14:21:48.263 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.14:21:48.290 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.14:21:48.317 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.14:21:48.442 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.14:21:48.565 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.14:21:49.035 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.14:21:49.090 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.14:21:49.091 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.14:21:49.091 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.14:21:49.155 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
25-01-13.14:21:49.161 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
25-01-13.14:21:59.103 [main            ] INFO  RebateTest             - Starting RebateTest using Java 1.8.0_151 on mile with PID 12104 (started by aaa in D:\Develop\project\rem-market\market-app)
25-01-13.14:21:59.104 [main            ] INFO  RebateTest             - The following 1 profile is active: "dev"
25-01-13.14:21:59.951 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-01-13.14:21:59.953 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-01-13.14:22:00.011 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 48 ms. Found 0 Redis repository interfaces.
25-01-13.14:22:01.423 [main            ] INFO  Version                - Redisson 3.26.0
25-01-13.14:22:02.172 [redisson-netty-1-6] INFO  ConnectionsHolder      - 1 connections initialized for 110.41.180.185/110.41.180.185:6379
25-01-13.14:22:02.372 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 110.41.180.185/110.41.180.185:6379
25-01-13.14:22:06.834 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-01-13.14:22:06.905 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [110.41.180.185:5672]
25-01-13.14:22:07.064 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#12448de1:0/SimpleConnection@5897aae1 [delegate=amqp://lain@110.41.180.185:5672/, localPort= 50742]
25-01-13.14:22:07.620 [main            ] INFO  RebateTest             - Started RebateTest in 8.917 seconds (JVM running for 9.961)
25-01-13.14:22:07.861 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-01-13.14:22:08.384 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-01-13.14:22:08.646 [main            ] ERROR BehaviorRebateRepository - 写入返利记录，唯一索引冲突 userId: rem
org.springframework.dao.DuplicateKeyException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry 'rem_sku_20250113' for key 'user_behavior_rebate_order.uq_biz_id'
### The error may exist in top/javarem/infrastructure/dao/mapper/UserBehaviorRebateOrderMapper.java (best guess)
### The error may involve top.javarem.infrastructure.dao.mapper.UserBehaviorRebateOrderMapper.insert-Inline
### The error occurred while setting parameters
### SQL: INSERT INTO user_behavior_rebate_order  ( user_id, order_id, behavior_type, rebate_desc, rebate_type, rebate_config, biz_id )  VALUES (  ?, ?, ?, ?, ?, ?, ?  )
### Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry 'rem_sku_20250113' for key 'user_behavior_rebate_order.uq_biz_id'
; Duplicate entry 'rem_sku_20250113' for key 'user_behavior_rebate_order.uq_biz_id'; nested exception is java.sql.SQLIntegrityConstraintViolationException: Duplicate entry 'rem_sku_20250113' for key 'user_behavior_rebate_order.uq_biz_id'
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:247)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:439)
	at com.sun.proxy.$Proxy96.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:272)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:59)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy$PlainMethodInvoker.invoke(MybatisMapperProxy.java:152)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:89)
	at com.sun.proxy.$Proxy113.insert(Unknown Source)
	at com.baomidou.mybatisplus.extension.service.IService.save(IService.java:61)
	at com.baomidou.mybatisplus.extension.service.IService$$FastClassBySpringCGLIB$$f8525d18.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386)
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704)
	at top.javarem.infrastructure.dao.iService.Impl.UserBehaviorRebateOrderServiceImpl$$EnhancerBySpringCGLIB$$79e4639c.save(<generated>)
	at top.javarem.infrastructure.adapter.repository.BehaviorRebateRepository.lambda$saveUserRebateRecord$0(BehaviorRebateRepository.java:87)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at top.javarem.infrastructure.adapter.repository.BehaviorRebateRepository.saveUserRebateRecord(BehaviorRebateRepository.java:74)
	at top.javarem.infrastructure.adapter.repository.BehaviorRebateRepository$$FastClassBySpringCGLIB$$1bd3c4c8.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at top.javarem.infrastructure.adapter.repository.BehaviorRebateRepository$$EnhancerBySpringCGLIB$$6dfe9b9.saveUserRebateRecord(<generated>)
	at top.javarem.domain.rebate.service.BehaviorRebateService.createOrder(BehaviorRebateService.java:85)
	at top.javarem.rebate.RebateTest.test_createOrder(RebateTest.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:725)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:140)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:84)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$7(TestMethodTestDescriptor.java:214)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:210)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:135)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:66)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1255)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1255)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)
	at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:53)
	at com.intellij.junit5.JUnit5IdeaTestRunner.startRunnerWithArgs(JUnit5IdeaTestRunner.java:57)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater$1.execute(IdeaTestRunner.java:38)
	at com.intellij.rt.execution.junit.TestsRepeater.repeat(TestsRepeater.java:11)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:35)
	at com.intellij.rt.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:232)
	at com.intellij.rt.junit.JUnitStarter.main(JUnitStarter.java:55)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry 'rem_sku_20250113' for key 'user_behavior_rebate_order.uq_biz_id'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:48)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:75)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:425)
	... 97 common frames omitted
25-01-13.14:22:08.756 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.14:22:08.783 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.14:22:08.811 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.14:22:09.371 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.14:22:09.512 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.14:22:09.650 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.14:22:09.653 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.14:22:09.654 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.14:22:09.654 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.14:22:09.690 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
25-01-13.14:22:09.709 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
25-01-13.14:23:14.071 [main            ] INFO  RebateTest             - Starting RebateTest using Java 1.8.0_151 on mile with PID 21228 (started by aaa in D:\Develop\project\rem-market\market-app)
25-01-13.14:23:14.072 [main            ] INFO  RebateTest             - The following 1 profile is active: "dev"
25-01-13.14:23:14.929 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-01-13.14:23:14.931 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-01-13.14:23:14.989 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 48 ms. Found 0 Redis repository interfaces.
25-01-13.14:23:16.384 [main            ] INFO  Version                - Redisson 3.26.0
25-01-13.14:23:17.160 [redisson-netty-1-6] INFO  ConnectionsHolder      - 1 connections initialized for 110.41.180.185/110.41.180.185:6379
25-01-13.14:23:17.366 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 110.41.180.185/110.41.180.185:6379
25-01-13.14:23:21.898 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-01-13.14:23:21.967 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [110.41.180.185:5672]
25-01-13.14:23:22.106 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#6dd20ec9:0/SimpleConnection@5897aae1 [delegate=amqp://lain@110.41.180.185:5672/, localPort= 50857]
25-01-13.14:23:22.554 [main            ] INFO  RebateTest             - Started RebateTest in 8.896 seconds (JVM running for 9.964)
25-01-13.14:23:22.793 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-01-13.14:23:23.281 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-01-13.14:23:23.691 [main            ] INFO  EventPublisher         - 发送MQ消息 topic: send_rebate message: BaseEvent.EventMessage(eventId=81833936652, timestamp=Mon Jan 13 14:23:23 CST 2025, data=SendRebateMessageEvent.RebateMessage(userId=rem, rebateDesc=签到返利-sku额度, rebateType=sku, rebateConfig=9011, bizId=rem_sku_20250114))
25-01-13.14:23:23.722 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"81833936652","timestamp":"Jan 13, 2025 2:23:23 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_20250114"}}
25-01-13.14:23:23.756 [main            ] INFO  EventPublisher         - 发送MQ消息 topic: send_rebate message: BaseEvent.EventMessage(eventId=45464668515, timestamp=Mon Jan 13 14:23:23 CST 2025, data=SendRebateMessageEvent.RebateMessage(userId=rem, rebateDesc=签到返利-积分, rebateType=integral, rebateConfig=10, bizId=rem_integral_20250114))
25-01-13.14:23:23.874 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=19) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.14:23:23.875 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.14:23:23.876 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SkuStockFilterChain    - 执行活动sku库存扣减责任链
25-01-13.14:23:23.918 [main            ] INFO  RebateTest             - 请求参数：{"behaviorType":"SIGN","outBusinessNo":"20250114","userId":"rem"}
25-01-13.14:23:23.922 [main            ] INFO  RebateTest             - 测试结果：["rem_sku_20250114","rem_integral_20250114"]
25-01-13.14:23:23.956 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.14:23:23.980 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.14:23:24.001 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.14:23:24.011 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - CreateQuotaOrderAggregate(userId=rem, activityId=100301, activityName=null, totalCount=1, monthCount=1, dayCount=1, activityOrder=ActivityOrderEntity(userId=rem, sku=9011, activityId=100301, activityName=测试活动, strategyId=100006, orderId=68982289264, orderTime=2025-01-13T14:23:24.009, totalCount=1, dayCount=1, monthCount=1, status=completed, outBusinessNo=rem_sku_20250114))
25-01-13.14:23:24.229 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.14:23:24.355 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.14:23:24.575 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.14:23:24.578 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.14:23:24.578 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.14:23:24.578 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.14:23:24.631 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
25-01-13.14:23:24.851 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
25-01-13.14:25:48.939 [main            ] INFO  RebateTest             - Starting RebateTest using Java 1.8.0_151 on mile with PID 3936 (started by aaa in D:\Develop\project\rem-market\market-app)
25-01-13.14:25:48.940 [main            ] INFO  RebateTest             - The following 1 profile is active: "dev"
25-01-13.14:25:49.818 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-01-13.14:25:49.820 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-01-13.14:25:49.879 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 49 ms. Found 0 Redis repository interfaces.
25-01-13.14:25:51.313 [main            ] INFO  Version                - Redisson 3.26.0
25-01-13.14:25:52.055 [redisson-netty-1-6] INFO  ConnectionsHolder      - 1 connections initialized for 110.41.180.185/110.41.180.185:6379
25-01-13.14:25:52.265 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 110.41.180.185/110.41.180.185:6379
25-01-13.14:25:56.725 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-01-13.14:25:56.791 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [110.41.180.185:5672]
25-01-13.14:25:56.951 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#6dd20ec9:0/SimpleConnection@5897aae1 [delegate=amqp://lain@110.41.180.185:5672/, localPort= 50955]
25-01-13.14:25:57.358 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"45464668515","timestamp":"Jan 13, 2025 2:23:23 PM","data":{"userId":"rem","rebateDesc":"签到返利-积分","rebateType":"integral","rebateConfig":"10","bizId":"rem_integral_20250114"}}
25-01-13.14:25:57.365 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户行为返利消息 - 非sku奖励暂时不处理 topic: send_rebate message: {"eventId":"45464668515","timestamp":"Jan 13, 2025 2:23:23 PM","data":{"userId":"rem","rebateDesc":"签到返利-积分","rebateType":"integral","rebateConfig":"10","bizId":"rem_integral_20250114"}}
25-01-13.14:25:57.509 [main            ] INFO  RebateTest             - Started RebateTest in 8.993 seconds (JVM running for 10.057)
25-01-13.14:25:57.751 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-01-13.14:25:58.269 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-01-13.14:25:58.691 [main            ] INFO  EventPublisher         - 发送MQ消息 topic: send_rebate message: BaseEvent.EventMessage(eventId=51197967248, timestamp=Mon Jan 13 14:25:58 CST 2025, data=SendRebateMessageEvent.RebateMessage(userId=rem, rebateDesc=签到返利-sku额度, rebateType=sku, rebateConfig=9011, bizId=rem_sku_20250115))
25-01-13.14:25:58.719 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"51197967248","timestamp":"Jan 13, 2025 2:25:58 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_20250115"}}
25-01-13.14:25:58.752 [main            ] INFO  EventPublisher         - 发送MQ消息 topic: send_rebate message: BaseEvent.EventMessage(eventId=92258080692, timestamp=Mon Jan 13 14:25:58 CST 2025, data=SendRebateMessageEvent.RebateMessage(userId=rem, rebateDesc=签到返利-积分, rebateType=integral, rebateConfig=10, bizId=rem_integral_20250115))
25-01-13.14:25:58.883 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=18) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.14:25:58.884 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.14:25:58.884 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SkuStockFilterChain    - 执行活动sku库存扣减责任链
25-01-13.14:25:58.926 [main            ] INFO  RebateTest             - 请求参数：{"behaviorType":"SIGN","outBusinessNo":"20250115","userId":"rem"}
25-01-13.14:25:58.930 [main            ] INFO  RebateTest             - 测试结果：["rem_sku_20250115","rem_integral_20250115"]
25-01-13.14:25:58.972 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.14:25:59.005 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.14:25:59.017 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - CreateQuotaOrderAggregate(userId=rem, activityId=100301, activityName=null, totalCount=1, monthCount=1, dayCount=1, activityOrder=ActivityOrderEntity(userId=rem, sku=9011, activityId=100301, activityName=测试活动, strategyId=100006, orderId=39596662615, orderTime=2025-01-13T14:25:59.016, totalCount=1, dayCount=1, monthCount=1, status=completed, outBusinessNo=rem_sku_20250115))
25-01-13.14:25:59.032 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.14:25:59.255 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.14:25:59.255 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.14:25:59.524 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.14:25:59.528 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.14:25:59.528 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.14:25:59.529 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.14:25:59.595 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
25-01-13.14:25:59.836 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
25-01-13.14:27:05.787 [main            ] INFO  RebateTest             - Starting RebateTest using Java 1.8.0_151 on mile with PID 22372 (started by aaa in D:\Develop\project\rem-market\market-app)
25-01-13.14:27:05.788 [main            ] INFO  RebateTest             - The following 1 profile is active: "dev"
25-01-13.14:27:06.639 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-01-13.14:27:06.642 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-01-13.14:27:06.699 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 47 ms. Found 0 Redis repository interfaces.
25-01-13.14:27:08.086 [main            ] INFO  Version                - Redisson 3.26.0
25-01-13.14:27:08.844 [redisson-netty-1-6] INFO  ConnectionsHolder      - 1 connections initialized for 110.41.180.185/110.41.180.185:6379
25-01-13.14:27:09.040 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 110.41.180.185/110.41.180.185:6379
25-01-13.14:27:13.486 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-01-13.14:27:13.565 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [110.41.180.185:5672]
25-01-13.14:27:13.728 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#35010a6b:0/SimpleConnection@17a77a7e [delegate=amqp://lain@110.41.180.185:5672/, localPort= 51043]
25-01-13.14:27:14.088 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"92258080692","timestamp":"Jan 13, 2025 2:25:58 PM","data":{"userId":"rem","rebateDesc":"签到返利-积分","rebateType":"integral","rebateConfig":"10","bizId":"rem_integral_20250115"}}
25-01-13.14:27:14.095 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户行为返利消息 - 非sku奖励暂时不处理 topic: send_rebate message: {"eventId":"92258080692","timestamp":"Jan 13, 2025 2:25:58 PM","data":{"userId":"rem","rebateDesc":"签到返利-积分","rebateType":"integral","rebateConfig":"10","bizId":"rem_integral_20250115"}}
25-01-13.14:27:14.219 [main            ] INFO  RebateTest             - Started RebateTest in 8.844 seconds (JVM running for 9.882)
25-01-13.14:27:14.456 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-01-13.14:27:14.999 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-01-13.14:27:15.444 [main            ] INFO  EventPublisher         - 发送MQ消息 topic: send_rebate message: BaseEvent.EventMessage(eventId=87676853608, timestamp=Mon Jan 13 14:27:15 CST 2025, data=SendRebateMessageEvent.RebateMessage(userId=rem, rebateDesc=签到返利-sku额度, rebateType=sku, rebateConfig=9011, bizId=rem_sku_21250115))
25-01-13.14:27:15.469 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"87676853608","timestamp":"Jan 13, 2025 2:27:15 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_21250115"}}
25-01-13.14:27:15.511 [main            ] INFO  EventPublisher         - 发送MQ消息 topic: send_rebate message: BaseEvent.EventMessage(eventId=10445796953, timestamp=Mon Jan 13 14:27:15 CST 2025, data=SendRebateMessageEvent.RebateMessage(userId=rem, rebateDesc=签到返利-积分, rebateType=integral, rebateConfig=10, bizId=rem_integral_21250115))
25-01-13.14:27:15.623 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=17) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.14:27:15.624 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.14:27:15.625 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SkuStockFilterChain    - 执行活动sku库存扣减责任链
25-01-13.14:27:15.691 [main            ] INFO  RebateTest             - 请求参数：{"behaviorType":"SIGN","outBusinessNo":"21250115","userId":"rem"}
25-01-13.14:27:15.695 [main            ] INFO  RebateTest             - 测试结果：["rem_sku_21250115","rem_integral_21250115"]
25-01-13.14:27:15.733 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.14:27:15.757 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.14:27:15.767 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - CreateQuotaOrderAggregate(userId=rem, activityId=100301, activityName=null, totalCount=1, monthCount=1, dayCount=1, activityOrder=ActivityOrderEntity(userId=rem, sku=9011, activityId=100301, activityName=测试活动, strategyId=100006, orderId=22420359996, orderTime=2025-01-13T14:27:15.765, totalCount=1, dayCount=1, monthCount=1, status=completed, outBusinessNo=rem_sku_21250115))
25-01-13.14:27:15.781 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.14:27:16.005 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.14:27:16.026 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.14:27:16.238 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.14:27:16.242 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.14:27:16.243 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.14:27:16.243 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.14:27:16.301 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
25-01-13.14:27:16.313 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
25-01-13.14:56:36.127 [main            ] INFO  RebateTest             - Starting RebateTest using Java 1.8.0_151 on mile with PID 15200 (started by aaa in D:\Develop\project\rem-market\market-app)
25-01-13.14:56:36.128 [main            ] INFO  RebateTest             - The following 1 profile is active: "dev"
25-01-13.14:56:37.001 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-01-13.14:56:37.003 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-01-13.14:56:37.061 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 47 ms. Found 0 Redis repository interfaces.
25-01-13.14:56:38.455 [main            ] INFO  Version                - Redisson 3.26.0
25-01-13.14:56:39.215 [redisson-netty-1-6] INFO  ConnectionsHolder      - 1 connections initialized for 110.41.180.185/110.41.180.185:6379
25-01-13.14:56:39.414 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 110.41.180.185/110.41.180.185:6379
25-01-13.14:56:44.054 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-01-13.14:56:44.143 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [110.41.180.185:5672]
25-01-13.14:56:44.297 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#36525ab:0/SimpleConnection@6ad3fbe4 [delegate=amqp://lain@110.41.180.185:5672/, localPort= 51233]
25-01-13.14:56:44.676 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"10445796953","timestamp":"Jan 13, 2025 2:27:15 PM","data":{"userId":"rem","rebateDesc":"签到返利-积分","rebateType":"integral","rebateConfig":"10","bizId":"rem_integral_21250115"}}
25-01-13.14:56:44.683 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户行为返利消息 - 非sku奖励暂时不处理 topic: send_rebate message: {"eventId":"10445796953","timestamp":"Jan 13, 2025 2:27:15 PM","data":{"userId":"rem","rebateDesc":"签到返利-积分","rebateType":"integral","rebateConfig":"10","bizId":"rem_integral_21250115"}}
25-01-13.14:56:44.813 [main            ] INFO  RebateTest             - Started RebateTest in 9.118 seconds (JVM running for 10.226)
25-01-13.14:56:45.074 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-01-13.14:56:45.579 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-01-13.14:56:46.012 [main            ] INFO  EventPublisher         - 发送MQ消息 topic: send_rebate message: BaseEvent.EventMessage(eventId=87703841805, timestamp=Mon Jan 13 14:56:45 CST 2025, data=SendRebateMessageEvent.RebateMessage(userId=rem, rebateDesc=签到返利-sku额度, rebateType=sku, rebateConfig=9011, bizId=rem_sku_22250115))
25-01-13.14:56:46.038 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"87703841805","timestamp":"Jan 13, 2025 2:56:45 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_22250115"}}
25-01-13.14:56:46.073 [main            ] INFO  EventPublisher         - 发送MQ消息 topic: send_rebate message: BaseEvent.EventMessage(eventId=71825765998, timestamp=Mon Jan 13 14:56:45 CST 2025, data=SendRebateMessageEvent.RebateMessage(userId=rem, rebateDesc=签到返利-积分, rebateType=integral, rebateConfig=10, bizId=rem_integral_22250115))
25-01-13.14:56:46.199 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=16) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.14:56:46.202 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.14:56:46.203 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SkuStockFilterChain    - 执行活动sku库存扣减责任链
25-01-13.14:56:46.251 [main            ] INFO  RebateTest             - 请求参数：{"behaviorType":"SIGN","outBusinessNo":"22250115","userId":"rem"}
25-01-13.14:56:46.254 [main            ] INFO  RebateTest             - 测试结果：["rem_sku_22250115","rem_integral_22250115"]
25-01-13.14:56:46.295 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.14:56:46.321 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.14:56:46.339 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - CreateQuotaOrderAggregate(userId=rem, activityId=100301, activityName=null, totalCount=1, monthCount=1, dayCount=1, activityOrder=ActivityOrderEntity(userId=rem, sku=9011, activityId=100301, activityName=测试活动, strategyId=100006, orderId=31852210948, orderTime=2025-01-13T14:56:46.337, totalCount=1, dayCount=1, monthCount=1, status=completed, outBusinessNo=rem_sku_22250115))
25-01-13.14:56:46.347 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.14:56:46.546 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] ERROR RebateMessageCustomer  - 监听用户行为返利消息，消费失败 topic: send_rebate message: {"eventId":"87703841805","timestamp":"Jan 13, 2025 2:56:45 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_22250115"}}
java.lang.NullPointerException: null
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountMonthCountServiceImpl.addAccountQuota(RaffleActivityAccountMonthCountServiceImpl.java:23)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountMonthCountServiceImpl$$FastClassBySpringCGLIB$$a756a034.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386)
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountMonthCountServiceImpl$$EnhancerBySpringCGLIB$$f46ea348.addAccountQuota(<generated>)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository.lambda$saveOrder$0(ActivityRepository.java:191)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository.saveOrder(ActivityRepository.java:181)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository$$FastClassBySpringCGLIB$$ae16c582.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository$$EnhancerBySpringCGLIB$$ee2d23a3.saveOrder(<generated>)
	at top.javarem.domain.activity.service.quota.RaffleActivityAccountQuotaService.saveOrder(RaffleActivityAccountQuotaService.java:57)
	at top.javarem.domain.activity.service.quota.AbstractRaffleActivityAccountQuotaService.createOrder(AbstractRaffleActivityAccountQuotaService.java:63)
	at top.javarem.trigger.listener.RebateMessageCustomer.listener(RebateMessageCustomer.java:53)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:77)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:263)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:209)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:148)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1674)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1593)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1581)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1572)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1516)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:1001)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:948)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:86)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1326)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1232)
	at java.lang.Thread.run(Thread.java:748)
25-01-13.14:56:46.547 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] WARN  ConditionalRejectingErrorHandler - Execution of Rabbit message listener failed.
org.springframework.amqp.rabbit.support.ListenerExecutionFailedException: Listener method 'public void top.javarem.trigger.listener.RebateMessageCustomer.listener(java.lang.String)' threw exception
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:272)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:209)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:148)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1674)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1593)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1581)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1572)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1516)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:1001)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:948)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:86)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1326)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1232)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.NullPointerException: null
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountMonthCountServiceImpl.addAccountQuota(RaffleActivityAccountMonthCountServiceImpl.java:23)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountMonthCountServiceImpl$$FastClassBySpringCGLIB$$a756a034.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386)
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountMonthCountServiceImpl$$EnhancerBySpringCGLIB$$f46ea348.addAccountQuota(<generated>)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository.lambda$saveOrder$0(ActivityRepository.java:191)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository.saveOrder(ActivityRepository.java:181)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository$$FastClassBySpringCGLIB$$ae16c582.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository$$EnhancerBySpringCGLIB$$ee2d23a3.saveOrder(<generated>)
	at top.javarem.domain.activity.service.quota.RaffleActivityAccountQuotaService.saveOrder(RaffleActivityAccountQuotaService.java:57)
	at top.javarem.domain.activity.service.quota.AbstractRaffleActivityAccountQuotaService.createOrder(AbstractRaffleActivityAccountQuotaService.java:63)
	at top.javarem.trigger.listener.RebateMessageCustomer.listener(RebateMessageCustomer.java:53)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:77)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:263)
	... 13 common frames omitted
25-01-13.14:56:46.575 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.14:56:46.575 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.14:56:46.847 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.14:56:46.850 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.14:56:46.850 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.14:56:46.851 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.14:56:46.912 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
25-01-13.14:56:47.140 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
25-01-13.15:44:34.539 [main            ] INFO  RebateTest             - Starting RebateTest using Java 1.8.0_151 on mile with PID 21300 (started by aaa in D:\Develop\project\rem-market\market-app)
25-01-13.15:44:34.540 [main            ] INFO  RebateTest             - The following 1 profile is active: "dev"
25-01-13.15:44:35.401 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-01-13.15:44:35.403 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-01-13.15:44:35.460 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 47 ms. Found 0 Redis repository interfaces.
25-01-13.15:44:36.877 [main            ] INFO  Version                - Redisson 3.26.0
25-01-13.15:44:37.638 [redisson-netty-1-6] INFO  ConnectionsHolder      - 1 connections initialized for 110.41.180.185/110.41.180.185:6379
25-01-13.15:44:37.848 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 110.41.180.185/110.41.180.185:6379
25-01-13.15:44:42.406 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-01-13.15:44:42.472 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [110.41.180.185:5672]
25-01-13.15:44:42.608 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#36525ab:0/SimpleConnection@6ad3fbe4 [delegate=amqp://lain@110.41.180.185:5672/, localPort= 51962]
25-01-13.15:44:42.933 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"87703841805","timestamp":"Jan 13, 2025 2:56:45 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_22250115"}}
25-01-13.15:44:43.057 [main            ] INFO  RebateTest             - Started RebateTest in 8.93 seconds (JVM running for 9.976)
25-01-13.15:44:43.100 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=15) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.15:44:43.101 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.15:44:43.102 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SkuStockFilterChain    - 执行活动sku库存扣减责任链
25-01-13.15:44:43.240 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - CreateQuotaOrderAggregate(userId=rem, activityId=100301, activityName=null, totalCount=1, monthCount=1, dayCount=1, activityOrder=ActivityOrderEntity(userId=rem, sku=9011, activityId=100301, activityName=测试活动, strategyId=100006, orderId=88448182545, orderTime=2025-01-13T15:44:43.239, totalCount=1, dayCount=1, monthCount=1, status=completed, outBusinessNo=rem_sku_22250115))
25-01-13.15:44:43.245 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-01-13.15:44:43.766 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-01-13.15:44:44.020 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] ERROR RebateMessageCustomer  - 监听用户行为返利消息，消费失败 topic: send_rebate message: {"eventId":"87703841805","timestamp":"Jan 13, 2025 2:56:45 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_22250115"}}
java.lang.NullPointerException: null
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountMonthCountServiceImpl.addAccountQuota(RaffleActivityAccountMonthCountServiceImpl.java:23)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountMonthCountServiceImpl$$FastClassBySpringCGLIB$$a756a034.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386)
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountMonthCountServiceImpl$$EnhancerBySpringCGLIB$$f46ea348.addAccountQuota(<generated>)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository.lambda$saveOrder$0(ActivityRepository.java:191)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository.saveOrder(ActivityRepository.java:181)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository$$FastClassBySpringCGLIB$$ae16c582.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository$$EnhancerBySpringCGLIB$$ee2d23a3.saveOrder(<generated>)
	at top.javarem.domain.activity.service.quota.RaffleActivityAccountQuotaService.saveOrder(RaffleActivityAccountQuotaService.java:57)
	at top.javarem.domain.activity.service.quota.AbstractRaffleActivityAccountQuotaService.createOrder(AbstractRaffleActivityAccountQuotaService.java:63)
	at top.javarem.trigger.listener.RebateMessageCustomer.listener(RebateMessageCustomer.java:53)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:77)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:263)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:209)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:148)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1674)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1593)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1581)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1572)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1516)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:1001)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:948)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:86)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1326)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1232)
	at java.lang.Thread.run(Thread.java:748)
25-01-13.15:44:44.020 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] WARN  ConditionalRejectingErrorHandler - Execution of Rabbit message listener failed.
org.springframework.amqp.rabbit.support.ListenerExecutionFailedException: Listener method 'public void top.javarem.trigger.listener.RebateMessageCustomer.listener(java.lang.String)' threw exception
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:272)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:209)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:148)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1674)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1593)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1581)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1572)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1516)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:1001)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:948)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:86)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1326)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1232)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.NullPointerException: null
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountMonthCountServiceImpl.addAccountQuota(RaffleActivityAccountMonthCountServiceImpl.java:23)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountMonthCountServiceImpl$$FastClassBySpringCGLIB$$a756a034.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386)
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountMonthCountServiceImpl$$EnhancerBySpringCGLIB$$f46ea348.addAccountQuota(<generated>)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository.lambda$saveOrder$0(ActivityRepository.java:191)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository.saveOrder(ActivityRepository.java:181)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository$$FastClassBySpringCGLIB$$ae16c582.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository$$EnhancerBySpringCGLIB$$ee2d23a3.saveOrder(<generated>)
	at top.javarem.domain.activity.service.quota.RaffleActivityAccountQuotaService.saveOrder(RaffleActivityAccountQuotaService.java:57)
	at top.javarem.domain.activity.service.quota.AbstractRaffleActivityAccountQuotaService.createOrder(AbstractRaffleActivityAccountQuotaService.java:63)
	at top.javarem.trigger.listener.RebateMessageCustomer.listener(RebateMessageCustomer.java:53)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:77)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:263)
	... 13 common frames omitted
25-01-13.15:44:44.044 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"87703841805","timestamp":"Jan 13, 2025 2:56:45 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_22250115"}}
25-01-13.15:44:44.150 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=14) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.15:44:44.150 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.15:44:44.150 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SkuStockFilterChain    - 执行活动sku库存扣减责任链
25-01-13.15:44:44.227 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - CreateQuotaOrderAggregate(userId=rem, activityId=100301, activityName=null, totalCount=1, monthCount=1, dayCount=1, activityOrder=ActivityOrderEntity(userId=rem, sku=9011, activityId=100301, activityName=测试活动, strategyId=100006, orderId=39677088634, orderTime=2025-01-13T15:44:44.227, totalCount=1, dayCount=1, monthCount=1, status=completed, outBusinessNo=rem_sku_22250115))
25-01-13.15:44:44.379 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] ERROR RebateMessageCustomer  - 监听用户行为返利消息，消费失败 topic: send_rebate message: {"eventId":"87703841805","timestamp":"Jan 13, 2025 2:56:45 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_22250115"}}
java.lang.NullPointerException: null
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountMonthCountServiceImpl.addAccountQuota(RaffleActivityAccountMonthCountServiceImpl.java:23)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountMonthCountServiceImpl$$FastClassBySpringCGLIB$$a756a034.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386)
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountMonthCountServiceImpl$$EnhancerBySpringCGLIB$$f46ea348.addAccountQuota(<generated>)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository.lambda$saveOrder$0(ActivityRepository.java:191)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository.saveOrder(ActivityRepository.java:181)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository$$FastClassBySpringCGLIB$$ae16c582.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository$$EnhancerBySpringCGLIB$$ee2d23a3.saveOrder(<generated>)
	at top.javarem.domain.activity.service.quota.RaffleActivityAccountQuotaService.saveOrder(RaffleActivityAccountQuotaService.java:57)
	at top.javarem.domain.activity.service.quota.AbstractRaffleActivityAccountQuotaService.createOrder(AbstractRaffleActivityAccountQuotaService.java:63)
	at top.javarem.trigger.listener.RebateMessageCustomer.listener(RebateMessageCustomer.java:53)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:77)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:263)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:209)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:148)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1674)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1593)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1581)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1572)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1516)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:1001)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:948)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:86)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1326)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1232)
	at java.lang.Thread.run(Thread.java:748)
25-01-13.15:44:44.380 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] WARN  ConditionalRejectingErrorHandler - Execution of Rabbit message listener failed.
org.springframework.amqp.rabbit.support.ListenerExecutionFailedException: Listener method 'public void top.javarem.trigger.listener.RebateMessageCustomer.listener(java.lang.String)' threw exception
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:272)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:209)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:148)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1674)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1593)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1581)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1572)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1516)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:1001)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:948)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:86)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1326)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1232)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.NullPointerException: null
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountMonthCountServiceImpl.addAccountQuota(RaffleActivityAccountMonthCountServiceImpl.java:23)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountMonthCountServiceImpl$$FastClassBySpringCGLIB$$a756a034.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386)
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountMonthCountServiceImpl$$EnhancerBySpringCGLIB$$f46ea348.addAccountQuota(<generated>)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository.lambda$saveOrder$0(ActivityRepository.java:191)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository.saveOrder(ActivityRepository.java:181)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository$$FastClassBySpringCGLIB$$ae16c582.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository$$EnhancerBySpringCGLIB$$ee2d23a3.saveOrder(<generated>)
	at top.javarem.domain.activity.service.quota.RaffleActivityAccountQuotaService.saveOrder(RaffleActivityAccountQuotaService.java:57)
	at top.javarem.domain.activity.service.quota.AbstractRaffleActivityAccountQuotaService.createOrder(AbstractRaffleActivityAccountQuotaService.java:63)
	at top.javarem.trigger.listener.RebateMessageCustomer.listener(RebateMessageCustomer.java:53)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:77)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:263)
	... 13 common frames omitted
25-01-13.15:44:44.387 [main            ] INFO  EventPublisher         - 发送MQ消息 topic: send_rebate message: BaseEvent.EventMessage(eventId=00499427345, timestamp=Mon Jan 13 15:44:44 CST 2025, data=SendRebateMessageEvent.RebateMessage(userId=rem, rebateDesc=签到返利-sku额度, rebateType=sku, rebateConfig=9011, bizId=rem_sku_23250115))
25-01-13.15:44:44.402 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"87703841805","timestamp":"Jan 13, 2025 2:56:45 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_22250115"}}
25-01-13.15:44:44.449 [main            ] INFO  EventPublisher         - 发送MQ消息 topic: send_rebate message: BaseEvent.EventMessage(eventId=54484770293, timestamp=Mon Jan 13 15:44:44 CST 2025, data=SendRebateMessageEvent.RebateMessage(userId=rem, rebateDesc=签到返利-积分, rebateType=integral, rebateConfig=10, bizId=rem_integral_23250115))
25-01-13.15:44:44.509 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=13) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.15:44:44.509 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.15:44:44.509 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SkuStockFilterChain    - 执行活动sku库存扣减责任链
25-01-13.15:44:44.588 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - CreateQuotaOrderAggregate(userId=rem, activityId=100301, activityName=null, totalCount=1, monthCount=1, dayCount=1, activityOrder=ActivityOrderEntity(userId=rem, sku=9011, activityId=100301, activityName=测试活动, strategyId=100006, orderId=50126776882, orderTime=2025-01-13T15:44:44.588, totalCount=1, dayCount=1, monthCount=1, status=completed, outBusinessNo=rem_sku_22250115))
25-01-13.15:44:44.628 [main            ] INFO  RebateTest             - 请求参数：{"behaviorType":"SIGN","outBusinessNo":"23250115","userId":"rem"}
25-01-13.15:44:44.631 [main            ] INFO  RebateTest             - 测试结果：["rem_sku_23250115","rem_integral_23250115"]
25-01-13.15:44:44.666 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.15:44:44.687 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.15:44:44.709 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.15:44:44.739 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] ERROR RebateMessageCustomer  - 监听用户行为返利消息，消费失败 topic: send_rebate message: {"eventId":"87703841805","timestamp":"Jan 13, 2025 2:56:45 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_22250115"}}
java.lang.NullPointerException: null
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountMonthCountServiceImpl.addAccountQuota(RaffleActivityAccountMonthCountServiceImpl.java:23)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountMonthCountServiceImpl$$FastClassBySpringCGLIB$$a756a034.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386)
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountMonthCountServiceImpl$$EnhancerBySpringCGLIB$$f46ea348.addAccountQuota(<generated>)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository.lambda$saveOrder$0(ActivityRepository.java:191)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository.saveOrder(ActivityRepository.java:181)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository$$FastClassBySpringCGLIB$$ae16c582.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository$$EnhancerBySpringCGLIB$$ee2d23a3.saveOrder(<generated>)
	at top.javarem.domain.activity.service.quota.RaffleActivityAccountQuotaService.saveOrder(RaffleActivityAccountQuotaService.java:57)
	at top.javarem.domain.activity.service.quota.AbstractRaffleActivityAccountQuotaService.createOrder(AbstractRaffleActivityAccountQuotaService.java:63)
	at top.javarem.trigger.listener.RebateMessageCustomer.listener(RebateMessageCustomer.java:53)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:77)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:263)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:209)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:148)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1674)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1593)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1581)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1572)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1516)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:1001)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:948)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:86)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1326)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1232)
	at java.lang.Thread.run(Thread.java:748)
25-01-13.15:44:44.739 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] WARN  ConditionalRejectingErrorHandler - Execution of Rabbit message listener failed.
org.springframework.amqp.rabbit.support.ListenerExecutionFailedException: Listener method 'public void top.javarem.trigger.listener.RebateMessageCustomer.listener(java.lang.String)' threw exception
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:272)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:209)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:148)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1674)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1593)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1581)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1572)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1516)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:1001)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:948)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:86)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1326)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1232)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.NullPointerException: null
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountMonthCountServiceImpl.addAccountQuota(RaffleActivityAccountMonthCountServiceImpl.java:23)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountMonthCountServiceImpl$$FastClassBySpringCGLIB$$a756a034.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386)
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountMonthCountServiceImpl$$EnhancerBySpringCGLIB$$f46ea348.addAccountQuota(<generated>)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository.lambda$saveOrder$0(ActivityRepository.java:191)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository.saveOrder(ActivityRepository.java:181)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository$$FastClassBySpringCGLIB$$ae16c582.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository$$EnhancerBySpringCGLIB$$ee2d23a3.saveOrder(<generated>)
	at top.javarem.domain.activity.service.quota.RaffleActivityAccountQuotaService.saveOrder(RaffleActivityAccountQuotaService.java:57)
	at top.javarem.domain.activity.service.quota.AbstractRaffleActivityAccountQuotaService.createOrder(AbstractRaffleActivityAccountQuotaService.java:63)
	at top.javarem.trigger.listener.RebateMessageCustomer.listener(RebateMessageCustomer.java:53)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:77)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:263)
	... 13 common frames omitted
25-01-13.15:44:44.763 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.15:44:44.843 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.15:44:45.078 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.15:44:45.081 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.15:44:45.081 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.15:44:45.082 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.15:44:45.137 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
25-01-13.15:44:45.226 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
25-01-13.16:05:25.765 [main            ] INFO  RebateTest             - Starting RebateTest using Java 1.8.0_151 on mile with PID 2332 (started by aaa in D:\Develop\project\rem-market\market-app)
25-01-13.16:05:25.780 [main            ] INFO  RebateTest             - The following 1 profile is active: "dev"
25-01-13.16:05:26.614 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-01-13.16:05:26.614 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-01-13.16:05:26.676 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 48 ms. Found 0 Redis repository interfaces.
25-01-13.16:05:28.103 [main            ] INFO  Version                - Redisson 3.26.0
25-01-13.16:05:28.840 [redisson-netty-1-6] INFO  ConnectionsHolder      - 1 connections initialized for 110.41.180.185/110.41.180.185:6379
25-01-13.16:05:29.061 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 110.41.180.185/110.41.180.185:6379
25-01-13.16:05:33.607 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-01-13.16:05:33.669 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [110.41.180.185:5672]
25-01-13.16:05:33.826 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#27438750:0/SimpleConnection@6aadb092 [delegate=amqp://lain@110.41.180.185:5672/, localPort= 52146]
25-01-13.16:05:34.223 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"87703841805","timestamp":"Jan 13, 2025 2:56:45 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_22250115"}}
25-01-13.16:05:34.379 [main            ] INFO  RebateTest             - Started RebateTest in 9.003 seconds (JVM running for 10.052)
25-01-13.16:05:34.395 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=12) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.16:05:34.395 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.16:05:34.395 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SkuStockFilterChain    - 执行活动sku库存扣减责任链
25-01-13.16:05:34.523 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - CreateQuotaOrderAggregate(userId=rem, activityId=100301, activityName=null, totalCount=1, monthCount=1, dayCount=1, activityOrder=ActivityOrderEntity(userId=rem, sku=9011, activityId=100301, activityName=测试活动, strategyId=100006, orderId=07991627147, orderTime=2025-01-13T16:05:34.523, totalCount=1, dayCount=1, monthCount=1, status=completed, outBusinessNo=rem_sku_22250115))
25-01-13.16:05:34.523 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-01-13.16:05:34.979 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-01-13.16:05:35.263 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] ERROR RebateMessageCustomer  - 监听用户行为返利消息，消费失败 topic: send_rebate message: {"eventId":"87703841805","timestamp":"Jan 13, 2025 2:56:45 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_22250115"}}
org.springframework.jdbc.BadSqlGrammarException: 
### Error updating database.  Cause: java.sql.SQLSyntaxErrorException: Table 'big_market.raffle_activity_account_month' doesn't exist
### The error may exist in file [D:\Develop\project\rem-market\market-app\target\classes\mapper\RaffleActivityAccountMonthCountMapper.xml]
### The error may involve top.javarem.infrastructure.dao.mapper.RaffleActivityAccountMonthCountMapper.addAccountQuota-Inline
### The error occurred while setting parameters
### SQL: update raffle_activity_account_month         set month_count_surplus = month_count_surplus + ?,             month_count = month_count + ?,             update_time = now()         where user_id = ? and activity_id = ? and month = ?
### Cause: java.sql.SQLSyntaxErrorException: Table 'big_market.raffle_activity_account_month' doesn't exist
; bad SQL grammar []; nested exception is java.sql.SQLSyntaxErrorException: Table 'big_market.raffle_activity_account_month' doesn't exist
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:239)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:439)
	at com.sun.proxy.$Proxy96.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:64)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy$PlainMethodInvoker.invoke(MybatisMapperProxy.java:152)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:89)
	at com.sun.proxy.$Proxy103.addAccountQuota(Unknown Source)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountMonthCountServiceImpl.addAccountQuota(RaffleActivityAccountMonthCountServiceImpl.java:25)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountMonthCountServiceImpl$$FastClassBySpringCGLIB$$a756a034.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386)
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountMonthCountServiceImpl$$EnhancerBySpringCGLIB$$f46ea348.addAccountQuota(<generated>)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository.lambda$saveOrder$0(ActivityRepository.java:191)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository.saveOrder(ActivityRepository.java:181)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository$$FastClassBySpringCGLIB$$ae16c582.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository$$EnhancerBySpringCGLIB$$29f12b3b.saveOrder(<generated>)
	at top.javarem.domain.activity.service.quota.RaffleActivityAccountQuotaService.saveOrder(RaffleActivityAccountQuotaService.java:57)
	at top.javarem.domain.activity.service.quota.AbstractRaffleActivityAccountQuotaService.createOrder(AbstractRaffleActivityAccountQuotaService.java:63)
	at top.javarem.trigger.listener.RebateMessageCustomer.listener(RebateMessageCustomer.java:53)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:77)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:263)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:209)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:148)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1674)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1593)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1581)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1572)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1516)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:1001)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:948)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:86)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1326)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1232)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.sql.SQLSyntaxErrorException: Table 'big_market.raffle_activity_account_month' doesn't exist
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:48)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:75)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:425)
	... 50 common frames omitted
25-01-13.16:05:35.263 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] WARN  ConditionalRejectingErrorHandler - Execution of Rabbit message listener failed.
org.springframework.amqp.rabbit.support.ListenerExecutionFailedException: Listener method 'public void top.javarem.trigger.listener.RebateMessageCustomer.listener(java.lang.String)' threw exception
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:272)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:209)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:148)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1674)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1593)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1581)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1572)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1516)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:1001)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:948)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:86)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1326)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1232)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.springframework.jdbc.BadSqlGrammarException: 
### Error updating database.  Cause: java.sql.SQLSyntaxErrorException: Table 'big_market.raffle_activity_account_month' doesn't exist
### The error may exist in file [D:\Develop\project\rem-market\market-app\target\classes\mapper\RaffleActivityAccountMonthCountMapper.xml]
### The error may involve top.javarem.infrastructure.dao.mapper.RaffleActivityAccountMonthCountMapper.addAccountQuota-Inline
### The error occurred while setting parameters
### SQL: update raffle_activity_account_month         set month_count_surplus = month_count_surplus + ?,             month_count = month_count + ?,             update_time = now()         where user_id = ? and activity_id = ? and month = ?
### Cause: java.sql.SQLSyntaxErrorException: Table 'big_market.raffle_activity_account_month' doesn't exist
; bad SQL grammar []; nested exception is java.sql.SQLSyntaxErrorException: Table 'big_market.raffle_activity_account_month' doesn't exist
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:239)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:439)
	at com.sun.proxy.$Proxy96.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:64)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy$PlainMethodInvoker.invoke(MybatisMapperProxy.java:152)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:89)
	at com.sun.proxy.$Proxy103.addAccountQuota(Unknown Source)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountMonthCountServiceImpl.addAccountQuota(RaffleActivityAccountMonthCountServiceImpl.java:25)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountMonthCountServiceImpl$$FastClassBySpringCGLIB$$a756a034.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386)
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountMonthCountServiceImpl$$EnhancerBySpringCGLIB$$f46ea348.addAccountQuota(<generated>)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository.lambda$saveOrder$0(ActivityRepository.java:191)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository.saveOrder(ActivityRepository.java:181)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository$$FastClassBySpringCGLIB$$ae16c582.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository$$EnhancerBySpringCGLIB$$29f12b3b.saveOrder(<generated>)
	at top.javarem.domain.activity.service.quota.RaffleActivityAccountQuotaService.saveOrder(RaffleActivityAccountQuotaService.java:57)
	at top.javarem.domain.activity.service.quota.AbstractRaffleActivityAccountQuotaService.createOrder(AbstractRaffleActivityAccountQuotaService.java:63)
	at top.javarem.trigger.listener.RebateMessageCustomer.listener(RebateMessageCustomer.java:53)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:77)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:263)
	... 13 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Table 'big_market.raffle_activity_account_month' doesn't exist
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:48)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:75)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:425)
	... 50 common frames omitted
25-01-13.16:05:35.295 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"87703841805","timestamp":"Jan 13, 2025 2:56:45 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_22250115"}}
25-01-13.16:05:35.407 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=11) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.16:05:35.407 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.16:05:35.407 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SkuStockFilterChain    - 执行活动sku库存扣减责任链
25-01-13.16:05:35.486 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - CreateQuotaOrderAggregate(userId=rem, activityId=100301, activityName=null, totalCount=1, monthCount=1, dayCount=1, activityOrder=ActivityOrderEntity(userId=rem, sku=9011, activityId=100301, activityName=测试活动, strategyId=100006, orderId=90291997639, orderTime=2025-01-13T16:05:35.486, totalCount=1, dayCount=1, monthCount=1, status=completed, outBusinessNo=rem_sku_22250115))
25-01-13.16:05:35.548 [main            ] INFO  EventPublisher         - 发送MQ消息 topic: send_rebate message: BaseEvent.EventMessage(eventId=88952360684, timestamp=Mon Jan 13 16:05:35 CST 2025, data=SendRebateMessageEvent.RebateMessage(userId=rem, rebateDesc=签到返利-sku额度, rebateType=sku, rebateConfig=9011, bizId=rem_sku_24250115))
25-01-13.16:05:35.595 [main            ] INFO  EventPublisher         - 发送MQ消息 topic: send_rebate message: BaseEvent.EventMessage(eventId=72950602329, timestamp=Mon Jan 13 16:05:35 CST 2025, data=SendRebateMessageEvent.RebateMessage(userId=rem, rebateDesc=签到返利-积分, rebateType=integral, rebateConfig=10, bizId=rem_integral_24250115))
25-01-13.16:05:35.673 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] ERROR RebateMessageCustomer  - 监听用户行为返利消息，消费失败 topic: send_rebate message: {"eventId":"87703841805","timestamp":"Jan 13, 2025 2:56:45 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_22250115"}}
org.springframework.jdbc.BadSqlGrammarException: 
### Error updating database.  Cause: java.sql.SQLSyntaxErrorException: Table 'big_market.raffle_activity_account_month' doesn't exist
### The error may exist in file [D:\Develop\project\rem-market\market-app\target\classes\mapper\RaffleActivityAccountMonthCountMapper.xml]
### The error may involve top.javarem.infrastructure.dao.mapper.RaffleActivityAccountMonthCountMapper.addAccountQuota-Inline
### The error occurred while setting parameters
### SQL: update raffle_activity_account_month         set month_count_surplus = month_count_surplus + ?,             month_count = month_count + ?,             update_time = now()         where user_id = ? and activity_id = ? and month = ?
### Cause: java.sql.SQLSyntaxErrorException: Table 'big_market.raffle_activity_account_month' doesn't exist
; bad SQL grammar []; nested exception is java.sql.SQLSyntaxErrorException: Table 'big_market.raffle_activity_account_month' doesn't exist
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:239)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:439)
	at com.sun.proxy.$Proxy96.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:64)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy$PlainMethodInvoker.invoke(MybatisMapperProxy.java:152)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:89)
	at com.sun.proxy.$Proxy103.addAccountQuota(Unknown Source)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountMonthCountServiceImpl.addAccountQuota(RaffleActivityAccountMonthCountServiceImpl.java:25)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountMonthCountServiceImpl$$FastClassBySpringCGLIB$$a756a034.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386)
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountMonthCountServiceImpl$$EnhancerBySpringCGLIB$$f46ea348.addAccountQuota(<generated>)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository.lambda$saveOrder$0(ActivityRepository.java:191)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository.saveOrder(ActivityRepository.java:181)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository$$FastClassBySpringCGLIB$$ae16c582.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository$$EnhancerBySpringCGLIB$$29f12b3b.saveOrder(<generated>)
	at top.javarem.domain.activity.service.quota.RaffleActivityAccountQuotaService.saveOrder(RaffleActivityAccountQuotaService.java:57)
	at top.javarem.domain.activity.service.quota.AbstractRaffleActivityAccountQuotaService.createOrder(AbstractRaffleActivityAccountQuotaService.java:63)
	at top.javarem.trigger.listener.RebateMessageCustomer.listener(RebateMessageCustomer.java:53)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:77)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:263)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:209)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:148)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1674)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1593)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1581)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1572)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1516)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:1001)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:948)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:86)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1326)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1232)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.sql.SQLSyntaxErrorException: Table 'big_market.raffle_activity_account_month' doesn't exist
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:48)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:75)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:425)
	... 50 common frames omitted
25-01-13.16:05:35.673 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] WARN  ConditionalRejectingErrorHandler - Execution of Rabbit message listener failed.
org.springframework.amqp.rabbit.support.ListenerExecutionFailedException: Listener method 'public void top.javarem.trigger.listener.RebateMessageCustomer.listener(java.lang.String)' threw exception
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:272)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:209)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:148)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1674)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1593)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1581)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1572)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1516)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:1001)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:948)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:86)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1326)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1232)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.springframework.jdbc.BadSqlGrammarException: 
### Error updating database.  Cause: java.sql.SQLSyntaxErrorException: Table 'big_market.raffle_activity_account_month' doesn't exist
### The error may exist in file [D:\Develop\project\rem-market\market-app\target\classes\mapper\RaffleActivityAccountMonthCountMapper.xml]
### The error may involve top.javarem.infrastructure.dao.mapper.RaffleActivityAccountMonthCountMapper.addAccountQuota-Inline
### The error occurred while setting parameters
### SQL: update raffle_activity_account_month         set month_count_surplus = month_count_surplus + ?,             month_count = month_count + ?,             update_time = now()         where user_id = ? and activity_id = ? and month = ?
### Cause: java.sql.SQLSyntaxErrorException: Table 'big_market.raffle_activity_account_month' doesn't exist
; bad SQL grammar []; nested exception is java.sql.SQLSyntaxErrorException: Table 'big_market.raffle_activity_account_month' doesn't exist
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:239)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:439)
	at com.sun.proxy.$Proxy96.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:64)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy$PlainMethodInvoker.invoke(MybatisMapperProxy.java:152)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:89)
	at com.sun.proxy.$Proxy103.addAccountQuota(Unknown Source)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountMonthCountServiceImpl.addAccountQuota(RaffleActivityAccountMonthCountServiceImpl.java:25)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountMonthCountServiceImpl$$FastClassBySpringCGLIB$$a756a034.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386)
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountMonthCountServiceImpl$$EnhancerBySpringCGLIB$$f46ea348.addAccountQuota(<generated>)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository.lambda$saveOrder$0(ActivityRepository.java:191)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository.saveOrder(ActivityRepository.java:181)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository$$FastClassBySpringCGLIB$$ae16c582.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository$$EnhancerBySpringCGLIB$$29f12b3b.saveOrder(<generated>)
	at top.javarem.domain.activity.service.quota.RaffleActivityAccountQuotaService.saveOrder(RaffleActivityAccountQuotaService.java:57)
	at top.javarem.domain.activity.service.quota.AbstractRaffleActivityAccountQuotaService.createOrder(AbstractRaffleActivityAccountQuotaService.java:63)
	at top.javarem.trigger.listener.RebateMessageCustomer.listener(RebateMessageCustomer.java:53)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:77)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:263)
	... 13 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Table 'big_market.raffle_activity_account_month' doesn't exist
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:48)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:75)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:425)
	... 50 common frames omitted
25-01-13.16:05:35.692 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"87703841805","timestamp":"Jan 13, 2025 2:56:45 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_22250115"}}
25-01-13.16:05:35.754 [main            ] INFO  RebateTest             - 请求参数：{"behaviorType":"SIGN","outBusinessNo":"24250115","userId":"rem"}
25-01-13.16:05:35.754 [main            ] INFO  RebateTest             - 测试结果：["rem_sku_24250115","rem_integral_24250115"]
25-01-13.16:05:35.802 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=10) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.16:05:35.802 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.16:05:35.802 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SkuStockFilterChain    - 执行活动sku库存扣减责任链
25-01-13.16:05:35.802 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.16:05:35.833 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.16:05:35.863 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.16:05:35.884 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - CreateQuotaOrderAggregate(userId=rem, activityId=100301, activityName=null, totalCount=1, monthCount=1, dayCount=1, activityOrder=ActivityOrderEntity(userId=rem, sku=9011, activityId=100301, activityName=测试活动, strategyId=100006, orderId=16593639900, orderTime=2025-01-13T16:05:35.884, totalCount=1, dayCount=1, monthCount=1, status=completed, outBusinessNo=rem_sku_22250115))
25-01-13.16:05:36.054 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] ERROR RebateMessageCustomer  - 监听用户行为返利消息，消费失败 topic: send_rebate message: {"eventId":"87703841805","timestamp":"Jan 13, 2025 2:56:45 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_22250115"}}
org.springframework.jdbc.BadSqlGrammarException: 
### Error updating database.  Cause: java.sql.SQLSyntaxErrorException: Table 'big_market.raffle_activity_account_month' doesn't exist
### The error may exist in file [D:\Develop\project\rem-market\market-app\target\classes\mapper\RaffleActivityAccountMonthCountMapper.xml]
### The error may involve top.javarem.infrastructure.dao.mapper.RaffleActivityAccountMonthCountMapper.addAccountQuota-Inline
### The error occurred while setting parameters
### SQL: update raffle_activity_account_month         set month_count_surplus = month_count_surplus + ?,             month_count = month_count + ?,             update_time = now()         where user_id = ? and activity_id = ? and month = ?
### Cause: java.sql.SQLSyntaxErrorException: Table 'big_market.raffle_activity_account_month' doesn't exist
; bad SQL grammar []; nested exception is java.sql.SQLSyntaxErrorException: Table 'big_market.raffle_activity_account_month' doesn't exist
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:239)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:439)
	at com.sun.proxy.$Proxy96.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:64)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy$PlainMethodInvoker.invoke(MybatisMapperProxy.java:152)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:89)
	at com.sun.proxy.$Proxy103.addAccountQuota(Unknown Source)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountMonthCountServiceImpl.addAccountQuota(RaffleActivityAccountMonthCountServiceImpl.java:25)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountMonthCountServiceImpl$$FastClassBySpringCGLIB$$a756a034.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386)
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountMonthCountServiceImpl$$EnhancerBySpringCGLIB$$f46ea348.addAccountQuota(<generated>)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository.lambda$saveOrder$0(ActivityRepository.java:191)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository.saveOrder(ActivityRepository.java:181)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository$$FastClassBySpringCGLIB$$ae16c582.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository$$EnhancerBySpringCGLIB$$29f12b3b.saveOrder(<generated>)
	at top.javarem.domain.activity.service.quota.RaffleActivityAccountQuotaService.saveOrder(RaffleActivityAccountQuotaService.java:57)
	at top.javarem.domain.activity.service.quota.AbstractRaffleActivityAccountQuotaService.createOrder(AbstractRaffleActivityAccountQuotaService.java:63)
	at top.javarem.trigger.listener.RebateMessageCustomer.listener(RebateMessageCustomer.java:53)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:77)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:263)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:209)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:148)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1674)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1593)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1581)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1572)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1516)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:1001)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:948)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:86)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1326)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1232)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.sql.SQLSyntaxErrorException: Table 'big_market.raffle_activity_account_month' doesn't exist
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:48)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:75)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:425)
	... 50 common frames omitted
25-01-13.16:05:36.054 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] WARN  ConditionalRejectingErrorHandler - Execution of Rabbit message listener failed.
org.springframework.amqp.rabbit.support.ListenerExecutionFailedException: Listener method 'public void top.javarem.trigger.listener.RebateMessageCustomer.listener(java.lang.String)' threw exception
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:272)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:209)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:148)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1674)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1593)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1581)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1572)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1516)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:1001)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:948)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:86)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1326)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1232)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.springframework.jdbc.BadSqlGrammarException: 
### Error updating database.  Cause: java.sql.SQLSyntaxErrorException: Table 'big_market.raffle_activity_account_month' doesn't exist
### The error may exist in file [D:\Develop\project\rem-market\market-app\target\classes\mapper\RaffleActivityAccountMonthCountMapper.xml]
### The error may involve top.javarem.infrastructure.dao.mapper.RaffleActivityAccountMonthCountMapper.addAccountQuota-Inline
### The error occurred while setting parameters
### SQL: update raffle_activity_account_month         set month_count_surplus = month_count_surplus + ?,             month_count = month_count + ?,             update_time = now()         where user_id = ? and activity_id = ? and month = ?
### Cause: java.sql.SQLSyntaxErrorException: Table 'big_market.raffle_activity_account_month' doesn't exist
; bad SQL grammar []; nested exception is java.sql.SQLSyntaxErrorException: Table 'big_market.raffle_activity_account_month' doesn't exist
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:239)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:439)
	at com.sun.proxy.$Proxy96.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:64)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy$PlainMethodInvoker.invoke(MybatisMapperProxy.java:152)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:89)
	at com.sun.proxy.$Proxy103.addAccountQuota(Unknown Source)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountMonthCountServiceImpl.addAccountQuota(RaffleActivityAccountMonthCountServiceImpl.java:25)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountMonthCountServiceImpl$$FastClassBySpringCGLIB$$a756a034.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386)
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountMonthCountServiceImpl$$EnhancerBySpringCGLIB$$f46ea348.addAccountQuota(<generated>)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository.lambda$saveOrder$0(ActivityRepository.java:191)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository.saveOrder(ActivityRepository.java:181)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository$$FastClassBySpringCGLIB$$ae16c582.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository$$EnhancerBySpringCGLIB$$29f12b3b.saveOrder(<generated>)
	at top.javarem.domain.activity.service.quota.RaffleActivityAccountQuotaService.saveOrder(RaffleActivityAccountQuotaService.java:57)
	at top.javarem.domain.activity.service.quota.AbstractRaffleActivityAccountQuotaService.createOrder(AbstractRaffleActivityAccountQuotaService.java:63)
	at top.javarem.trigger.listener.RebateMessageCustomer.listener(RebateMessageCustomer.java:53)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:77)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:263)
	... 13 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Table 'big_market.raffle_activity_account_month' doesn't exist
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:48)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:75)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:425)
	... 50 common frames omitted
25-01-13.16:05:36.085 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.16:05:36.132 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.16:05:36.401 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.16:05:36.416 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.16:05:36.416 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.16:05:36.416 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.16:05:36.482 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
25-01-13.16:05:36.748 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
25-01-13.16:10:11.853 [main            ] INFO  RebateTest             - Starting RebateTest using Java 1.8.0_151 on mile with PID 5332 (started by aaa in D:\Develop\project\rem-market\market-app)
25-01-13.16:10:11.853 [main            ] INFO  RebateTest             - The following 1 profile is active: "dev"
25-01-13.16:10:12.715 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-01-13.16:10:12.715 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-01-13.16:10:12.762 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 47 ms. Found 0 Redis repository interfaces.
25-01-13.16:10:14.199 [main            ] INFO  Version                - Redisson 3.26.0
25-01-13.16:10:14.950 [redisson-netty-1-6] INFO  ConnectionsHolder      - 1 connections initialized for 110.41.180.185/110.41.180.185:6379
25-01-13.16:10:15.191 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 110.41.180.185/110.41.180.185:6379
25-01-13.16:10:19.655 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-01-13.16:10:19.717 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [110.41.180.185:5672]
25-01-13.16:10:19.874 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#6249a08d:0/SimpleConnection@7c03f9d0 [delegate=amqp://lain@110.41.180.185:5672/, localPort= 52264]
25-01-13.16:10:20.270 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"87703841805","timestamp":"Jan 13, 2025 2:56:45 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_22250115"}}
25-01-13.16:10:20.401 [main            ] INFO  RebateTest             - Started RebateTest in 8.946 seconds (JVM running for 9.983)
25-01-13.16:10:20.432 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=9) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.16:10:20.448 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.16:10:20.448 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SkuStockFilterChain    - 执行活动sku库存扣减责任链
25-01-13.16:10:20.590 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - CreateQuotaOrderAggregate(userId=rem, activityId=100301, activityName=null, totalCount=1, monthCount=1, dayCount=1, activityOrder=ActivityOrderEntity(userId=rem, sku=9011, activityId=100301, activityName=测试活动, strategyId=100006, orderId=57480825791, orderTime=2025-01-13T16:10:20.573, totalCount=1, dayCount=1, monthCount=1, status=completed, outBusinessNo=rem_sku_22250115))
25-01-13.16:10:20.592 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-01-13.16:10:21.115 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-01-13.16:10:21.559 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] ERROR RebateMessageCustomer  - 监听用户行为返利消息，消费失败 topic: send_rebate message: {"eventId":"87703841805","timestamp":"Jan 13, 2025 2:56:45 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_22250115"}}
org.springframework.jdbc.BadSqlGrammarException: 
### Error updating database.  Cause: java.sql.SQLSyntaxErrorException: Table 'big_market.raffle_activity_account_day_acount' doesn't exist
### The error may exist in file [D:\Develop\project\rem-market\market-app\target\classes\mapper\RaffleActivityAccountDayCountMapper.xml]
### The error may involve top.javarem.infrastructure.dao.mapper.RaffleActivityAccountDayCountMapper.addAccountQuota-Inline
### The error occurred while setting parameters
### SQL: update raffle_activity_account_day_acount         set day_count_surplus = day_count_surplus + ?,             day_count = day_count + ?,             update_time = now()         where user_id = ? and activity_id = ? and day = ?
### Cause: java.sql.SQLSyntaxErrorException: Table 'big_market.raffle_activity_account_day_acount' doesn't exist
; bad SQL grammar []; nested exception is java.sql.SQLSyntaxErrorException: Table 'big_market.raffle_activity_account_day_acount' doesn't exist
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:239)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:439)
	at com.sun.proxy.$Proxy96.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:64)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy$PlainMethodInvoker.invoke(MybatisMapperProxy.java:152)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:89)
	at com.sun.proxy.$Proxy104.addAccountQuota(Unknown Source)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountDayCountServiceImpl.addAccountQuota(RaffleActivityAccountDayCountServiceImpl.java:25)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountDayCountServiceImpl$$FastClassBySpringCGLIB$$c6545cd0.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386)
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountDayCountServiceImpl$$EnhancerBySpringCGLIB$$9aa187fd.addAccountQuota(<generated>)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository.lambda$saveOrder$0(ActivityRepository.java:193)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository.saveOrder(ActivityRepository.java:181)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository$$FastClassBySpringCGLIB$$ae16c582.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository$$EnhancerBySpringCGLIB$$b4ddba0f.saveOrder(<generated>)
	at top.javarem.domain.activity.service.quota.RaffleActivityAccountQuotaService.saveOrder(RaffleActivityAccountQuotaService.java:57)
	at top.javarem.domain.activity.service.quota.AbstractRaffleActivityAccountQuotaService.createOrder(AbstractRaffleActivityAccountQuotaService.java:63)
	at top.javarem.trigger.listener.RebateMessageCustomer.listener(RebateMessageCustomer.java:53)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:77)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:263)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:209)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:148)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1674)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1593)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1581)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1572)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1516)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:1001)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:948)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:86)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1326)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1232)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.sql.SQLSyntaxErrorException: Table 'big_market.raffle_activity_account_day_acount' doesn't exist
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:48)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:75)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:425)
	... 50 common frames omitted
25-01-13.16:10:21.559 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] WARN  ConditionalRejectingErrorHandler - Execution of Rabbit message listener failed.
org.springframework.amqp.rabbit.support.ListenerExecutionFailedException: Listener method 'public void top.javarem.trigger.listener.RebateMessageCustomer.listener(java.lang.String)' threw exception
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:272)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:209)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:148)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1674)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1593)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1581)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1572)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1516)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:1001)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:948)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:86)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1326)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1232)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.springframework.jdbc.BadSqlGrammarException: 
### Error updating database.  Cause: java.sql.SQLSyntaxErrorException: Table 'big_market.raffle_activity_account_day_acount' doesn't exist
### The error may exist in file [D:\Develop\project\rem-market\market-app\target\classes\mapper\RaffleActivityAccountDayCountMapper.xml]
### The error may involve top.javarem.infrastructure.dao.mapper.RaffleActivityAccountDayCountMapper.addAccountQuota-Inline
### The error occurred while setting parameters
### SQL: update raffle_activity_account_day_acount         set day_count_surplus = day_count_surplus + ?,             day_count = day_count + ?,             update_time = now()         where user_id = ? and activity_id = ? and day = ?
### Cause: java.sql.SQLSyntaxErrorException: Table 'big_market.raffle_activity_account_day_acount' doesn't exist
; bad SQL grammar []; nested exception is java.sql.SQLSyntaxErrorException: Table 'big_market.raffle_activity_account_day_acount' doesn't exist
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:239)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:439)
	at com.sun.proxy.$Proxy96.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:64)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy$PlainMethodInvoker.invoke(MybatisMapperProxy.java:152)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:89)
	at com.sun.proxy.$Proxy104.addAccountQuota(Unknown Source)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountDayCountServiceImpl.addAccountQuota(RaffleActivityAccountDayCountServiceImpl.java:25)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountDayCountServiceImpl$$FastClassBySpringCGLIB$$c6545cd0.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386)
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountDayCountServiceImpl$$EnhancerBySpringCGLIB$$9aa187fd.addAccountQuota(<generated>)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository.lambda$saveOrder$0(ActivityRepository.java:193)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository.saveOrder(ActivityRepository.java:181)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository$$FastClassBySpringCGLIB$$ae16c582.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository$$EnhancerBySpringCGLIB$$b4ddba0f.saveOrder(<generated>)
	at top.javarem.domain.activity.service.quota.RaffleActivityAccountQuotaService.saveOrder(RaffleActivityAccountQuotaService.java:57)
	at top.javarem.domain.activity.service.quota.AbstractRaffleActivityAccountQuotaService.createOrder(AbstractRaffleActivityAccountQuotaService.java:63)
	at top.javarem.trigger.listener.RebateMessageCustomer.listener(RebateMessageCustomer.java:53)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:77)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:263)
	... 13 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Table 'big_market.raffle_activity_account_day_acount' doesn't exist
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:48)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:75)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:425)
	... 50 common frames omitted
25-01-13.16:10:21.587 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"87703841805","timestamp":"Jan 13, 2025 2:56:45 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_22250115"}}
25-01-13.16:10:21.702 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=8) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.16:10:21.702 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.16:10:21.702 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SkuStockFilterChain    - 执行活动sku库存扣减责任链
25-01-13.16:10:21.780 [main            ] INFO  EventPublisher         - 发送MQ消息 topic: send_rebate message: BaseEvent.EventMessage(eventId=10104349899, timestamp=Mon Jan 13 16:10:21 CST 2025, data=SendRebateMessageEvent.RebateMessage(userId=rem, rebateDesc=签到返利-sku额度, rebateType=sku, rebateConfig=9011, bizId=rem_sku_20250110))
25-01-13.16:10:21.795 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - CreateQuotaOrderAggregate(userId=rem, activityId=100301, activityName=null, totalCount=1, monthCount=1, dayCount=1, activityOrder=ActivityOrderEntity(userId=rem, sku=9011, activityId=100301, activityName=测试活动, strategyId=100006, orderId=22730639302, orderTime=2025-01-13T16:10:21.795, totalCount=1, dayCount=1, monthCount=1, status=completed, outBusinessNo=rem_sku_22250115))
25-01-13.16:10:21.842 [main            ] INFO  EventPublisher         - 发送MQ消息 topic: send_rebate message: BaseEvent.EventMessage(eventId=16845652788, timestamp=Mon Jan 13 16:10:21 CST 2025, data=SendRebateMessageEvent.RebateMessage(userId=rem, rebateDesc=签到返利-积分, rebateType=integral, rebateConfig=10, bizId=rem_integral_20250110))
25-01-13.16:10:22.001 [main            ] INFO  RebateTest             - 请求参数：{"behaviorType":"SIGN","outBusinessNo":"20250110","userId":"rem"}
25-01-13.16:10:22.017 [main            ] INFO  RebateTest             - 测试结果：["rem_sku_20250110","rem_integral_20250110"]
25-01-13.16:10:22.048 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.16:10:22.079 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.16:10:22.111 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.16:10:22.111 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] ERROR RebateMessageCustomer  - 监听用户行为返利消息，消费失败 topic: send_rebate message: {"eventId":"87703841805","timestamp":"Jan 13, 2025 2:56:45 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_22250115"}}
org.springframework.jdbc.BadSqlGrammarException: 
### Error updating database.  Cause: java.sql.SQLSyntaxErrorException: Table 'big_market.raffle_activity_account_day_acount' doesn't exist
### The error may exist in file [D:\Develop\project\rem-market\market-app\target\classes\mapper\RaffleActivityAccountDayCountMapper.xml]
### The error may involve top.javarem.infrastructure.dao.mapper.RaffleActivityAccountDayCountMapper.addAccountQuota-Inline
### The error occurred while setting parameters
### SQL: update raffle_activity_account_day_acount         set day_count_surplus = day_count_surplus + ?,             day_count = day_count + ?,             update_time = now()         where user_id = ? and activity_id = ? and day = ?
### Cause: java.sql.SQLSyntaxErrorException: Table 'big_market.raffle_activity_account_day_acount' doesn't exist
; bad SQL grammar []; nested exception is java.sql.SQLSyntaxErrorException: Table 'big_market.raffle_activity_account_day_acount' doesn't exist
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:239)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:439)
	at com.sun.proxy.$Proxy96.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:64)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy$PlainMethodInvoker.invoke(MybatisMapperProxy.java:152)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:89)
	at com.sun.proxy.$Proxy104.addAccountQuota(Unknown Source)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountDayCountServiceImpl.addAccountQuota(RaffleActivityAccountDayCountServiceImpl.java:25)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountDayCountServiceImpl$$FastClassBySpringCGLIB$$c6545cd0.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386)
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountDayCountServiceImpl$$EnhancerBySpringCGLIB$$9aa187fd.addAccountQuota(<generated>)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository.lambda$saveOrder$0(ActivityRepository.java:193)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository.saveOrder(ActivityRepository.java:181)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository$$FastClassBySpringCGLIB$$ae16c582.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository$$EnhancerBySpringCGLIB$$b4ddba0f.saveOrder(<generated>)
	at top.javarem.domain.activity.service.quota.RaffleActivityAccountQuotaService.saveOrder(RaffleActivityAccountQuotaService.java:57)
	at top.javarem.domain.activity.service.quota.AbstractRaffleActivityAccountQuotaService.createOrder(AbstractRaffleActivityAccountQuotaService.java:63)
	at top.javarem.trigger.listener.RebateMessageCustomer.listener(RebateMessageCustomer.java:53)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:77)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:263)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:209)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:148)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1674)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1593)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1581)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1572)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1516)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:1001)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:948)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:86)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1326)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1232)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.sql.SQLSyntaxErrorException: Table 'big_market.raffle_activity_account_day_acount' doesn't exist
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:48)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:75)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:425)
	... 50 common frames omitted
25-01-13.16:10:22.111 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] WARN  ConditionalRejectingErrorHandler - Execution of Rabbit message listener failed.
org.springframework.amqp.rabbit.support.ListenerExecutionFailedException: Listener method 'public void top.javarem.trigger.listener.RebateMessageCustomer.listener(java.lang.String)' threw exception
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:272)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:209)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:148)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1674)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1593)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1581)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1572)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1516)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:1001)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:948)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:86)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1326)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1232)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.springframework.jdbc.BadSqlGrammarException: 
### Error updating database.  Cause: java.sql.SQLSyntaxErrorException: Table 'big_market.raffle_activity_account_day_acount' doesn't exist
### The error may exist in file [D:\Develop\project\rem-market\market-app\target\classes\mapper\RaffleActivityAccountDayCountMapper.xml]
### The error may involve top.javarem.infrastructure.dao.mapper.RaffleActivityAccountDayCountMapper.addAccountQuota-Inline
### The error occurred while setting parameters
### SQL: update raffle_activity_account_day_acount         set day_count_surplus = day_count_surplus + ?,             day_count = day_count + ?,             update_time = now()         where user_id = ? and activity_id = ? and day = ?
### Cause: java.sql.SQLSyntaxErrorException: Table 'big_market.raffle_activity_account_day_acount' doesn't exist
; bad SQL grammar []; nested exception is java.sql.SQLSyntaxErrorException: Table 'big_market.raffle_activity_account_day_acount' doesn't exist
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:239)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:439)
	at com.sun.proxy.$Proxy96.update(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.update(SqlSessionTemplate.java:288)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:64)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy$PlainMethodInvoker.invoke(MybatisMapperProxy.java:152)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:89)
	at com.sun.proxy.$Proxy104.addAccountQuota(Unknown Source)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountDayCountServiceImpl.addAccountQuota(RaffleActivityAccountDayCountServiceImpl.java:25)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountDayCountServiceImpl$$FastClassBySpringCGLIB$$c6545cd0.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386)
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704)
	at top.javarem.infrastructure.dao.iService.Impl.RaffleActivityAccountDayCountServiceImpl$$EnhancerBySpringCGLIB$$9aa187fd.addAccountQuota(<generated>)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository.lambda$saveOrder$0(ActivityRepository.java:193)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository.saveOrder(ActivityRepository.java:181)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository$$FastClassBySpringCGLIB$$ae16c582.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at top.javarem.infrastructure.adapter.repository.ActivityRepository$$EnhancerBySpringCGLIB$$b4ddba0f.saveOrder(<generated>)
	at top.javarem.domain.activity.service.quota.RaffleActivityAccountQuotaService.saveOrder(RaffleActivityAccountQuotaService.java:57)
	at top.javarem.domain.activity.service.quota.AbstractRaffleActivityAccountQuotaService.createOrder(AbstractRaffleActivityAccountQuotaService.java:63)
	at top.javarem.trigger.listener.RebateMessageCustomer.listener(RebateMessageCustomer.java:53)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:77)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:263)
	... 13 common frames omitted
Caused by: java.sql.SQLSyntaxErrorException: Table 'big_market.raffle_activity_account_day_acount' doesn't exist
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:120)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:48)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:75)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:425)
	... 50 common frames omitted
25-01-13.16:10:22.142 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.16:10:22.158 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.16:10:22.426 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.16:10:22.442 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.16:10:22.457 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.16:10:22.457 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.16:10:22.508 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
25-01-13.16:10:22.624 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
25-01-13.16:13:27.758 [main            ] INFO  RebateTest             - Starting RebateTest using Java 1.8.0_151 on mile with PID 12300 (started by aaa in D:\Develop\project\rem-market\market-app)
25-01-13.16:13:27.758 [main            ] INFO  RebateTest             - The following 1 profile is active: "dev"
25-01-13.16:13:28.649 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-01-13.16:13:28.651 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-01-13.16:13:28.709 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 48 ms. Found 0 Redis repository interfaces.
25-01-13.16:13:30.113 [main            ] INFO  Version                - Redisson 3.26.0
25-01-13.16:13:30.884 [redisson-netty-1-6] INFO  ConnectionsHolder      - 1 connections initialized for 110.41.180.185/110.41.180.185:6379
25-01-13.16:13:31.081 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 110.41.180.185/110.41.180.185:6379
25-01-13.16:13:35.607 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-01-13.16:13:35.685 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [110.41.180.185:5672]
25-01-13.16:13:35.814 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#35010a6b:0/SimpleConnection@17a77a7e [delegate=amqp://lain@110.41.180.185:5672/, localPort= 52357]
25-01-13.16:13:36.135 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"87703841805","timestamp":"Jan 13, 2025 2:56:45 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_22250115"}}
25-01-13.16:13:36.245 [main            ] INFO  RebateTest             - Started RebateTest in 8.881 seconds (JVM running for 9.938)
25-01-13.16:13:36.291 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=7) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.16:13:36.307 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.16:13:36.307 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SkuStockFilterChain    - 执行活动sku库存扣减责任链
25-01-13.16:13:36.435 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - CreateQuotaOrderAggregate(userId=rem, activityId=100301, activityName=null, totalCount=1, monthCount=1, dayCount=1, activityOrder=ActivityOrderEntity(userId=rem, sku=9011, activityId=100301, activityName=测试活动, strategyId=100006, orderId=23410319908, orderTime=2025-01-13T16:13:36.435, totalCount=1, dayCount=1, monthCount=1, status=completed, outBusinessNo=rem_sku_22250115))
25-01-13.16:13:36.435 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-01-13.16:13:37.054 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-01-13.16:13:37.498 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"71825765998","timestamp":"Jan 13, 2025 2:56:45 PM","data":{"userId":"rem","rebateDesc":"签到返利-积分","rebateType":"integral","rebateConfig":"10","bizId":"rem_integral_22250115"}}
25-01-13.16:13:37.498 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户行为返利消息 - 非sku奖励暂时不处理 topic: send_rebate message: {"eventId":"71825765998","timestamp":"Jan 13, 2025 2:56:45 PM","data":{"userId":"rem","rebateDesc":"签到返利-积分","rebateType":"integral","rebateConfig":"10","bizId":"rem_integral_22250115"}}
25-01-13.16:13:37.529 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"00499427345","timestamp":"Jan 13, 2025 3:44:44 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_23250115"}}
25-01-13.16:13:37.561 [main            ] INFO  EventPublisher         - 发送MQ消息 topic: send_rebate message: BaseEvent.EventMessage(eventId=39369633115, timestamp=Mon Jan 13 16:13:37 CST 2025, data=SendRebateMessageEvent.RebateMessage(userId=rem, rebateDesc=签到返利-sku额度, rebateType=sku, rebateConfig=9011, bizId=rem_sku_20250111))
25-01-13.16:13:37.623 [main            ] INFO  EventPublisher         - 发送MQ消息 topic: send_rebate message: BaseEvent.EventMessage(eventId=06757940317, timestamp=Mon Jan 13 16:13:37 CST 2025, data=SendRebateMessageEvent.RebateMessage(userId=rem, rebateDesc=签到返利-积分, rebateType=integral, rebateConfig=10, bizId=rem_integral_20250111))
25-01-13.16:13:37.639 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=6) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.16:13:37.639 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.16:13:37.639 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SkuStockFilterChain    - 执行活动sku库存扣减责任链
25-01-13.16:13:37.719 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - CreateQuotaOrderAggregate(userId=rem, activityId=100301, activityName=null, totalCount=1, monthCount=1, dayCount=1, activityOrder=ActivityOrderEntity(userId=rem, sku=9011, activityId=100301, activityName=测试活动, strategyId=100006, orderId=36555587089, orderTime=2025-01-13T16:13:37.719, totalCount=1, dayCount=1, monthCount=1, status=completed, outBusinessNo=rem_sku_23250115))
25-01-13.16:13:37.782 [main            ] INFO  RebateTest             - 请求参数：{"behaviorType":"SIGN","outBusinessNo":"20250111","userId":"rem"}
25-01-13.16:13:37.782 [main            ] INFO  RebateTest             - 测试结果：["rem_sku_20250111","rem_integral_20250111"]
25-01-13.16:13:37.813 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.16:13:37.844 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.16:13:37.860 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.16:13:38.066 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.16:13:38.098 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.16:13:38.270 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.16:13:38.270 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.16:13:38.270 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.16:13:38.270 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.16:13:38.319 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
25-01-13.16:13:38.413 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
25-01-13.16:15:57.019 [main            ] INFO  RebateTest             - Starting RebateTest using Java 1.8.0_151 on mile with PID 17472 (started by aaa in D:\Develop\project\rem-market\market-app)
25-01-13.16:15:57.019 [main            ] INFO  RebateTest             - The following 1 profile is active: "dev"
25-01-13.16:15:57.856 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-01-13.16:15:57.856 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-01-13.16:15:57.919 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 48 ms. Found 0 Redis repository interfaces.
25-01-13.16:15:59.300 [main            ] INFO  Version                - Redisson 3.26.0
25-01-13.16:16:00.067 [redisson-netty-1-6] INFO  ConnectionsHolder      - 1 connections initialized for 110.41.180.185/110.41.180.185:6379
25-01-13.16:16:00.273 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 110.41.180.185/110.41.180.185:6379
25-01-13.16:16:04.846 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-01-13.16:16:04.911 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [110.41.180.185:5672]
25-01-13.16:16:05.074 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#21280cbb:0/SimpleConnection@5f5923ef [delegate=amqp://lain@110.41.180.185:5672/, localPort= 52456]
25-01-13.16:16:05.441 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"54484770293","timestamp":"Jan 13, 2025 3:44:44 PM","data":{"userId":"rem","rebateDesc":"签到返利-积分","rebateType":"integral","rebateConfig":"10","bizId":"rem_integral_23250115"}}
25-01-13.16:16:05.441 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户行为返利消息 - 非sku奖励暂时不处理 topic: send_rebate message: {"eventId":"54484770293","timestamp":"Jan 13, 2025 3:44:44 PM","data":{"userId":"rem","rebateDesc":"签到返利-积分","rebateType":"integral","rebateConfig":"10","bizId":"rem_integral_23250115"}}
25-01-13.16:16:05.473 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"88952360684","timestamp":"Jan 13, 2025 4:05:35 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_24250115"}}
25-01-13.16:16:05.566 [main            ] INFO  RebateTest             - Started RebateTest in 8.948 seconds (JVM running for 9.989)
25-01-13.16:16:05.632 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=5) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.16:16:05.633 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.16:16:05.634 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SkuStockFilterChain    - 执行活动sku库存扣减责任链
25-01-13.16:16:05.772 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - CreateQuotaOrderAggregate(userId=rem, activityId=100301, activityName=null, totalCount=1, monthCount=1, dayCount=1, activityOrder=ActivityOrderEntity(userId=rem, sku=9011, activityId=100301, activityName=测试活动, strategyId=100006, orderId=81741737924, orderTime=2025-01-13T16:16:05.757, totalCount=1, dayCount=1, monthCount=1, status=completed, outBusinessNo=rem_sku_24250115))
25-01-13.16:16:05.772 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-01-13.16:16:06.222 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-01-13.16:16:06.520 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"72950602329","timestamp":"Jan 13, 2025 4:05:35 PM","data":{"userId":"rem","rebateDesc":"签到返利-积分","rebateType":"integral","rebateConfig":"10","bizId":"rem_integral_24250115"}}
25-01-13.16:16:06.520 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户行为返利消息 - 非sku奖励暂时不处理 topic: send_rebate message: {"eventId":"72950602329","timestamp":"Jan 13, 2025 4:05:35 PM","data":{"userId":"rem","rebateDesc":"签到返利-积分","rebateType":"integral","rebateConfig":"10","bizId":"rem_integral_24250115"}}
25-01-13.16:16:06.551 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"10104349899","timestamp":"Jan 13, 2025 4:10:21 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_20250110"}}
25-01-13.16:16:06.660 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=4) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.16:16:06.660 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.16:16:06.660 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SkuStockFilterChain    - 执行活动sku库存扣减责任链
25-01-13.16:16:06.741 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - CreateQuotaOrderAggregate(userId=rem, activityId=100301, activityName=null, totalCount=1, monthCount=1, dayCount=1, activityOrder=ActivityOrderEntity(userId=rem, sku=9011, activityId=100301, activityName=测试活动, strategyId=100006, orderId=84677981222, orderTime=2025-01-13T16:16:06.741, totalCount=1, dayCount=1, monthCount=1, status=completed, outBusinessNo=rem_sku_20250110))
25-01-13.16:16:06.835 [main            ] INFO  EventPublisher         - 发送MQ消息 topic: send_rebate message: BaseEvent.EventMessage(eventId=10707452764, timestamp=Mon Jan 13 16:16:06 CST 2025, data=SendRebateMessageEvent.RebateMessage(userId=rem, rebateDesc=签到返利-sku额度, rebateType=sku, rebateConfig=9011, bizId=rem_sku_20250112))
25-01-13.16:16:06.898 [main            ] INFO  EventPublisher         - 发送MQ消息 topic: send_rebate message: BaseEvent.EventMessage(eventId=75590291617, timestamp=Mon Jan 13 16:16:06 CST 2025, data=SendRebateMessageEvent.RebateMessage(userId=rem, rebateDesc=签到返利-积分, rebateType=integral, rebateConfig=10, bizId=rem_integral_20250112))
25-01-13.16:16:06.976 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"16845652788","timestamp":"Jan 13, 2025 4:10:21 PM","data":{"userId":"rem","rebateDesc":"签到返利-积分","rebateType":"integral","rebateConfig":"10","bizId":"rem_integral_20250110"}}
25-01-13.16:16:06.976 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户行为返利消息 - 非sku奖励暂时不处理 topic: send_rebate message: {"eventId":"16845652788","timestamp":"Jan 13, 2025 4:10:21 PM","data":{"userId":"rem","rebateDesc":"签到返利-积分","rebateType":"integral","rebateConfig":"10","bizId":"rem_integral_20250110"}}
25-01-13.16:16:07.009 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"39369633115","timestamp":"Jan 13, 2025 4:13:37 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_20250111"}}
25-01-13.16:16:07.073 [main            ] INFO  RebateTest             - 请求参数：{"behaviorType":"SIGN","outBusinessNo":"20250112","userId":"rem"}
25-01-13.16:16:07.073 [main            ] INFO  RebateTest             - 测试结果：["rem_sku_20250112","rem_integral_20250112"]
25-01-13.16:16:07.104 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=3) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.16:16:07.104 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.16:16:07.104 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SkuStockFilterChain    - 执行活动sku库存扣减责任链
25-01-13.16:16:07.104 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.16:16:07.136 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.16:16:07.151 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.16:16:07.198 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - CreateQuotaOrderAggregate(userId=rem, activityId=100301, activityName=null, totalCount=1, monthCount=1, dayCount=1, activityOrder=ActivityOrderEntity(userId=rem, sku=9011, activityId=100301, activityName=测试活动, strategyId=100006, orderId=63405337440, orderTime=2025-01-13T16:16:07.198, totalCount=1, dayCount=1, monthCount=1, status=completed, outBusinessNo=rem_sku_20250111))
25-01-13.16:16:07.342 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.16:16:07.442 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.16:16:07.598 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.16:16:07.598 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.16:16:07.598 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.16:16:07.598 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.16:16:07.661 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
25-01-13.16:16:07.898 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
25-01-13.16:24:26.839 [main            ] INFO  RebateTest             - Starting RebateTest using Java 1.8.0_151 on mile with PID 21088 (started by aaa in D:\Develop\project\rem-market\market-app)
25-01-13.16:24:26.839 [main            ] INFO  RebateTest             - The following 1 profile is active: "dev"
25-01-13.16:24:27.669 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-01-13.16:24:27.671 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-01-13.16:24:27.716 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 48 ms. Found 0 Redis repository interfaces.
25-01-13.16:24:29.139 [main            ] INFO  Version                - Redisson 3.26.0
25-01-13.16:24:29.905 [redisson-netty-1-6] INFO  ConnectionsHolder      - 1 connections initialized for 110.41.180.185/110.41.180.185:6379
25-01-13.16:24:30.126 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 110.41.180.185/110.41.180.185:6379
25-01-13.16:24:34.613 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-01-13.16:24:34.694 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [110.41.180.185:5672]
25-01-13.16:24:34.835 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#21280cbb:0/SimpleConnection@5f5923ef [delegate=amqp://lain@110.41.180.185:5672/, localPort= 52590]
25-01-13.16:24:35.226 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"06757940317","timestamp":"Jan 13, 2025 4:13:37 PM","data":{"userId":"rem","rebateDesc":"签到返利-积分","rebateType":"integral","rebateConfig":"10","bizId":"rem_integral_20250111"}}
25-01-13.16:24:35.242 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户行为返利消息 - 非sku奖励暂时不处理 topic: send_rebate message: {"eventId":"06757940317","timestamp":"Jan 13, 2025 4:13:37 PM","data":{"userId":"rem","rebateDesc":"签到返利-积分","rebateType":"integral","rebateConfig":"10","bizId":"rem_integral_20250111"}}
25-01-13.16:24:35.273 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"10707452764","timestamp":"Jan 13, 2025 4:16:06 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_20250112"}}
25-01-13.16:24:35.367 [main            ] INFO  RebateTest             - Started RebateTest in 8.926 seconds (JVM running for 9.953)
25-01-13.16:24:35.429 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=2) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.16:24:35.429 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.16:24:35.429 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SkuStockFilterChain    - 执行活动sku库存扣减责任链
25-01-13.16:24:35.573 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - CreateQuotaOrderAggregate(userId=rem, activityId=100301, activityName=null, totalCount=1, monthCount=1, dayCount=1, activityOrder=ActivityOrderEntity(userId=rem, sku=9011, activityId=100301, activityName=测试活动, strategyId=100006, orderId=99078481730, orderTime=2025-01-13T16:24:35.573, totalCount=1, dayCount=1, monthCount=1, status=completed, outBusinessNo=rem_sku_20250112))
25-01-13.16:24:35.589 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-01-13.16:24:36.099 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-01-13.16:24:36.479 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"75590291617","timestamp":"Jan 13, 2025 4:16:06 PM","data":{"userId":"rem","rebateDesc":"签到返利-积分","rebateType":"integral","rebateConfig":"10","bizId":"rem_integral_20250112"}}
25-01-13.16:24:36.479 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户行为返利消息 - 非sku奖励暂时不处理 topic: send_rebate message: {"eventId":"75590291617","timestamp":"Jan 13, 2025 4:16:06 PM","data":{"userId":"rem","rebateDesc":"签到返利-积分","rebateType":"integral","rebateConfig":"10","bizId":"rem_integral_20250112"}}
25-01-13.16:24:36.795 [main            ] INFO  EventPublisher         - 发送MQ消息 topic: send_rebate message: BaseEvent.EventMessage(eventId=25026192682, timestamp=Mon Jan 13 16:24:36 CST 2025, data=SendRebateMessageEvent.RebateMessage(userId=rem, rebateDesc=签到返利-sku额度, rebateType=sku, rebateConfig=9011, bizId=rem_sku_20250103))
25-01-13.16:24:36.827 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"25026192682","timestamp":"Jan 13, 2025 4:24:36 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_20250103"}}
25-01-13.16:24:36.858 [main            ] INFO  EventPublisher         - 发送MQ消息 topic: send_rebate message: BaseEvent.EventMessage(eventId=15067670869, timestamp=Mon Jan 13 16:24:36 CST 2025, data=SendRebateMessageEvent.RebateMessage(userId=rem, rebateDesc=签到返利-积分, rebateType=integral, rebateConfig=10, bizId=rem_integral_20250103))
25-01-13.16:24:36.936 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=1) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.16:24:36.936 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.16:24:36.951 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SkuStockFilterChain    - 执行活动sku库存扣减责任链
25-01-13.16:24:36.983 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  EventPublisher         - 发送MQ消息 topic: activity_sku_stock_zero message: BaseEvent.EventMessage(eventId=55345122233, timestamp=Mon Jan 13 16:24:36 CST 2025, data=9011)
25-01-13.16:24:36.983 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - CreateQuotaOrderAggregate(userId=rem, activityId=100301, activityName=null, totalCount=1, monthCount=1, dayCount=1, activityOrder=ActivityOrderEntity(userId=rem, sku=9011, activityId=100301, activityName=测试活动, strategyId=100006, orderId=41554197025, orderTime=2025-01-13T16:24:36.983, totalCount=1, dayCount=1, monthCount=1, status=completed, outBusinessNo=rem_sku_20250103))
25-01-13.16:24:36.998 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  ActivitySkuStockZeroCustomer - 活动sku库存为0消息消费 topic: activity_sku_stock_zero message:{"eventId":"55345122233","timestamp":"Jan 13, 2025 4:24:36 PM","data":9011}
25-01-13.16:24:37.048 [main            ] INFO  RebateTest             - 请求参数：{"behaviorType":"SIGN","outBusinessNo":"20250103","userId":"rem"}
25-01-13.16:24:37.048 [main            ] INFO  RebateTest             - 测试结果：["rem_sku_20250103","rem_integral_20250103"]
25-01-13.16:24:37.096 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.16:24:37.111 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.16:24:37.111 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.16:24:37.148 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.16:24:37.322 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.16:24:37.388 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.16:24:37.388 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.16:24:37.388 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.16:24:37.388 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.16:24:37.463 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
25-01-13.16:24:37.494 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
25-01-13.16:25:33.326 [main            ] INFO  RebateTest             - Starting RebateTest using Java 1.8.0_151 on mile with PID 916 (started by aaa in D:\Develop\project\rem-market\market-app)
25-01-13.16:25:33.326 [main            ] INFO  RebateTest             - The following 1 profile is active: "dev"
25-01-13.16:25:34.187 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-01-13.16:25:34.187 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-01-13.16:25:34.250 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 48 ms. Found 0 Redis repository interfaces.
25-01-13.16:25:35.626 [main            ] INFO  Version                - Redisson 3.26.0
25-01-13.16:25:36.391 [redisson-netty-1-6] INFO  ConnectionsHolder      - 1 connections initialized for 110.41.180.185/110.41.180.185:6379
25-01-13.16:25:36.595 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 110.41.180.185/110.41.180.185:6379
25-01-13.16:25:41.160 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-01-13.16:25:41.238 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [110.41.180.185:5672]
25-01-13.16:25:41.395 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#698f4aa:0/SimpleConnection@1f547af8 [delegate=amqp://lain@110.41.180.185:5672/, localPort= 52679]
25-01-13.16:25:41.792 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"15067670869","timestamp":"Jan 13, 2025 4:24:36 PM","data":{"userId":"rem","rebateDesc":"签到返利-积分","rebateType":"integral","rebateConfig":"10","bizId":"rem_integral_20250103"}}
25-01-13.16:25:41.807 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户行为返利消息 - 非sku奖励暂时不处理 topic: send_rebate message: {"eventId":"15067670869","timestamp":"Jan 13, 2025 4:24:36 PM","data":{"userId":"rem","rebateDesc":"签到返利-积分","rebateType":"integral","rebateConfig":"10","bizId":"rem_integral_20250103"}}
25-01-13.16:25:41.948 [main            ] INFO  RebateTest             - Started RebateTest in 8.999 seconds (JVM running for 10.029)
25-01-13.16:25:42.170 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-01-13.16:25:42.662 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-01-13.16:25:43.093 [main            ] INFO  EventPublisher         - 发送MQ消息 topic: send_rebate message: BaseEvent.EventMessage(eventId=70729864269, timestamp=Mon Jan 13 16:25:42 CST 2025, data=SendRebateMessageEvent.RebateMessage(userId=rem, rebateDesc=签到返利-sku额度, rebateType=sku, rebateConfig=9011, bizId=rem_sku_20250104))
25-01-13.16:25:43.125 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"70729864269","timestamp":"Jan 13, 2025 4:25:42 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_20250104"}}
25-01-13.16:25:43.146 [main            ] INFO  EventPublisher         - 发送MQ消息 topic: send_rebate message: BaseEvent.EventMessage(eventId=96791092578, timestamp=Mon Jan 13 16:25:42 CST 2025, data=SendRebateMessageEvent.RebateMessage(userId=rem, rebateDesc=签到返利-积分, rebateType=integral, rebateConfig=10, bizId=rem_integral_20250104))
25-01-13.16:25:43.292 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=0) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.16:25:43.292 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.16:25:43.292 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] WARN  ConditionalRejectingErrorHandler - Execution of Rabbit message listener failed.
org.springframework.amqp.rabbit.support.ListenerExecutionFailedException: Listener method 'public void top.javarem.trigger.listener.RebateMessageCustomer.listener(java.lang.String)' threw exception
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:272)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:209)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:148)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1674)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1593)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1581)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1572)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1516)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:1001)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:948)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:86)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1326)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1232)
	at java.lang.Thread.run(Thread.java:748)
Caused by: top.javarem.types.exception.AppException: null
	at top.javarem.domain.activity.service.quota.rule.impl.BaseFilterChain.execute(BaseFilterChain.java:36)
	at top.javarem.domain.activity.service.quota.AbstractRaffleActivityAccountQuotaService.createOrder(AbstractRaffleActivityAccountQuotaService.java:50)
	at top.javarem.trigger.listener.RebateMessageCustomer.listener(RebateMessageCustomer.java:53)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:77)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:263)
	... 13 common frames omitted
Caused by: java.lang.Throwable: 活动库存为空
	at top.javarem.types.exception.AppException.<init>(AppException.java:30)
	... 24 common frames omitted
25-01-13.16:25:43.329 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"70729864269","timestamp":"Jan 13, 2025 4:25:42 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_20250104"}}
25-01-13.16:25:43.329 [main            ] INFO  RebateTest             - 请求参数：{"behaviorType":"SIGN","outBusinessNo":"20250104","userId":"rem"}
25-01-13.16:25:43.329 [main            ] INFO  RebateTest             - 测试结果：["rem_sku_20250104","rem_integral_20250104"]
25-01-13.16:25:43.361 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.16:25:43.392 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.16:25:43.423 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.16:25:43.439 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=0) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.16:25:43.439 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.16:25:43.439 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] WARN  ConditionalRejectingErrorHandler - Execution of Rabbit message listener failed.
org.springframework.amqp.rabbit.support.ListenerExecutionFailedException: Listener method 'public void top.javarem.trigger.listener.RebateMessageCustomer.listener(java.lang.String)' threw exception
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:272)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:209)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:148)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1674)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1593)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1581)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1572)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1516)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:1001)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:948)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:86)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1326)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1232)
	at java.lang.Thread.run(Thread.java:748)
Caused by: top.javarem.types.exception.AppException: null
	at top.javarem.domain.activity.service.quota.rule.impl.BaseFilterChain.execute(BaseFilterChain.java:36)
	at top.javarem.domain.activity.service.quota.AbstractRaffleActivityAccountQuotaService.createOrder(AbstractRaffleActivityAccountQuotaService.java:50)
	at top.javarem.trigger.listener.RebateMessageCustomer.listener(RebateMessageCustomer.java:53)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:77)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:263)
	... 13 common frames omitted
Caused by: java.lang.Throwable: 活动库存为空
	at top.javarem.types.exception.AppException.<init>(AppException.java:30)
	... 24 common frames omitted
25-01-13.16:25:43.470 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.16:25:43.692 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.16:25:43.961 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.16:25:43.976 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.16:25:43.976 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.16:25:43.976 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.16:25:44.039 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
25-01-13.16:25:44.309 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
25-01-13.16:28:37.099 [main            ] INFO  RebateTest             - Starting RebateTest using Java 1.8.0_151 on mile with PID 8820 (started by aaa in D:\Develop\project\rem-market\market-app)
25-01-13.16:28:37.100 [main            ] INFO  RebateTest             - The following 1 profile is active: "dev"
25-01-13.16:28:37.931 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-01-13.16:28:37.931 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-01-13.16:28:37.998 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 47 ms. Found 0 Redis repository interfaces.
25-01-13.16:28:39.387 [main            ] INFO  Version                - Redisson 3.26.0
25-01-13.16:28:40.152 [redisson-netty-1-6] INFO  ConnectionsHolder      - 1 connections initialized for 110.41.180.185/110.41.180.185:6379
25-01-13.16:28:40.360 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 110.41.180.185/110.41.180.185:6379
25-01-13.16:28:45.042 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-01-13.16:28:45.117 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [110.41.180.185:5672]
25-01-13.16:28:45.258 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#21280cbb:0/SimpleConnection@2f262474 [delegate=amqp://lain@110.41.180.185:5672/, localPort= 52767]
25-01-13.16:28:45.621 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"70729864269","timestamp":"Jan 13, 2025 4:25:42 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_20250104"}}
25-01-13.16:28:45.750 [main            ] INFO  RebateTest             - Started RebateTest in 9.048 seconds (JVM running for 10.089)
25-01-13.16:28:45.796 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=0) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.16:28:45.796 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.16:28:45.796 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] WARN  ConditionalRejectingErrorHandler - Execution of Rabbit message listener failed.
org.springframework.amqp.rabbit.support.ListenerExecutionFailedException: Listener method 'public void top.javarem.trigger.listener.RebateMessageCustomer.listener(java.lang.String)' threw exception
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:272)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:209)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:148)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1674)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1593)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1581)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1572)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1516)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:1001)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:948)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:86)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1326)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1232)
	at java.lang.Thread.run(Thread.java:748)
Caused by: top.javarem.types.exception.AppException: null
	at top.javarem.domain.activity.service.quota.rule.impl.BaseFilterChain.execute(BaseFilterChain.java:36)
	at top.javarem.domain.activity.service.quota.AbstractRaffleActivityAccountQuotaService.createOrder(AbstractRaffleActivityAccountQuotaService.java:50)
	at top.javarem.trigger.listener.RebateMessageCustomer.listener(RebateMessageCustomer.java:53)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:77)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:263)
	... 13 common frames omitted
Caused by: java.lang.Throwable: 活动库存为空
	at top.javarem.types.exception.AppException.<init>(AppException.java:30)
	... 24 common frames omitted
25-01-13.16:28:45.827 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"70729864269","timestamp":"Jan 13, 2025 4:25:42 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_20250104"}}
25-01-13.16:28:45.943 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=0) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.16:28:45.943 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.16:28:45.943 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] WARN  ConditionalRejectingErrorHandler - Execution of Rabbit message listener failed.
org.springframework.amqp.rabbit.support.ListenerExecutionFailedException: Listener method 'public void top.javarem.trigger.listener.RebateMessageCustomer.listener(java.lang.String)' threw exception
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:272)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:209)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:148)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1674)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1593)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1581)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1572)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1516)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:1001)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:948)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:86)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1326)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1232)
	at java.lang.Thread.run(Thread.java:748)
Caused by: top.javarem.types.exception.AppException: null
	at top.javarem.domain.activity.service.quota.rule.impl.BaseFilterChain.execute(BaseFilterChain.java:36)
	at top.javarem.domain.activity.service.quota.AbstractRaffleActivityAccountQuotaService.createOrder(AbstractRaffleActivityAccountQuotaService.java:50)
	at top.javarem.trigger.listener.RebateMessageCustomer.listener(RebateMessageCustomer.java:53)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:77)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:263)
	... 13 common frames omitted
Caused by: java.lang.Throwable: 活动库存为空
	at top.javarem.types.exception.AppException.<init>(AppException.java:30)
	... 24 common frames omitted
25-01-13.16:28:45.974 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"70729864269","timestamp":"Jan 13, 2025 4:25:42 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_20250104"}}
25-01-13.16:28:46.005 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-01-13.16:28:46.084 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=0) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.16:28:46.084 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.16:28:46.084 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] WARN  ConditionalRejectingErrorHandler - Execution of Rabbit message listener failed.
org.springframework.amqp.rabbit.support.ListenerExecutionFailedException: Listener method 'public void top.javarem.trigger.listener.RebateMessageCustomer.listener(java.lang.String)' threw exception
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:272)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:209)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:148)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1674)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1593)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1581)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1572)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1516)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:1001)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:948)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:86)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1326)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1232)
	at java.lang.Thread.run(Thread.java:748)
Caused by: top.javarem.types.exception.AppException: null
	at top.javarem.domain.activity.service.quota.rule.impl.BaseFilterChain.execute(BaseFilterChain.java:36)
	at top.javarem.domain.activity.service.quota.AbstractRaffleActivityAccountQuotaService.createOrder(AbstractRaffleActivityAccountQuotaService.java:50)
	at top.javarem.trigger.listener.RebateMessageCustomer.listener(RebateMessageCustomer.java:53)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:77)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:263)
	... 13 common frames omitted
Caused by: java.lang.Throwable: 活动库存为空
	at top.javarem.types.exception.AppException.<init>(AppException.java:30)
	... 24 common frames omitted
25-01-13.16:28:46.115 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"70729864269","timestamp":"Jan 13, 2025 4:25:42 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_20250104"}}
25-01-13.16:28:46.212 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=0) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.16:28:46.227 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.16:28:46.227 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] WARN  ConditionalRejectingErrorHandler - Execution of Rabbit message listener failed.
org.springframework.amqp.rabbit.support.ListenerExecutionFailedException: Listener method 'public void top.javarem.trigger.listener.RebateMessageCustomer.listener(java.lang.String)' threw exception
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:272)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:209)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:148)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1674)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1593)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1581)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1572)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1516)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:1001)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:948)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:86)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1326)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1232)
	at java.lang.Thread.run(Thread.java:748)
Caused by: top.javarem.types.exception.AppException: null
	at top.javarem.domain.activity.service.quota.rule.impl.BaseFilterChain.execute(BaseFilterChain.java:36)
	at top.javarem.domain.activity.service.quota.AbstractRaffleActivityAccountQuotaService.createOrder(AbstractRaffleActivityAccountQuotaService.java:50)
	at top.javarem.trigger.listener.RebateMessageCustomer.listener(RebateMessageCustomer.java:53)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:77)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:263)
	... 13 common frames omitted
Caused by: java.lang.Throwable: 活动库存为空
	at top.javarem.types.exception.AppException.<init>(AppException.java:30)
	... 24 common frames omitted
25-01-13.16:28:46.242 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"70729864269","timestamp":"Jan 13, 2025 4:25:42 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_20250104"}}
25-01-13.16:28:46.358 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=0) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.16:28:46.358 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.16:28:46.358 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] WARN  ConditionalRejectingErrorHandler - Execution of Rabbit message listener failed.
org.springframework.amqp.rabbit.support.ListenerExecutionFailedException: Listener method 'public void top.javarem.trigger.listener.RebateMessageCustomer.listener(java.lang.String)' threw exception
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:272)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:209)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:148)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1674)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1593)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1581)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1572)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1516)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:1001)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:948)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:86)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1326)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1232)
	at java.lang.Thread.run(Thread.java:748)
Caused by: top.javarem.types.exception.AppException: null
	at top.javarem.domain.activity.service.quota.rule.impl.BaseFilterChain.execute(BaseFilterChain.java:36)
	at top.javarem.domain.activity.service.quota.AbstractRaffleActivityAccountQuotaService.createOrder(AbstractRaffleActivityAccountQuotaService.java:50)
	at top.javarem.trigger.listener.RebateMessageCustomer.listener(RebateMessageCustomer.java:53)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:77)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:263)
	... 13 common frames omitted
Caused by: java.lang.Throwable: 活动库存为空
	at top.javarem.types.exception.AppException.<init>(AppException.java:30)
	... 24 common frames omitted
25-01-13.16:28:46.373 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"70729864269","timestamp":"Jan 13, 2025 4:25:42 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_20250104"}}
25-01-13.16:28:46.452 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-01-13.16:28:46.483 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=0) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.16:28:46.483 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.16:28:46.498 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] WARN  ConditionalRejectingErrorHandler - Execution of Rabbit message listener failed.
org.springframework.amqp.rabbit.support.ListenerExecutionFailedException: Listener method 'public void top.javarem.trigger.listener.RebateMessageCustomer.listener(java.lang.String)' threw exception
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:272)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:209)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:148)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1674)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1593)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1581)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1572)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1516)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:1001)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:948)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:86)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1326)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1232)
	at java.lang.Thread.run(Thread.java:748)
Caused by: top.javarem.types.exception.AppException: null
	at top.javarem.domain.activity.service.quota.rule.impl.BaseFilterChain.execute(BaseFilterChain.java:36)
	at top.javarem.domain.activity.service.quota.AbstractRaffleActivityAccountQuotaService.createOrder(AbstractRaffleActivityAccountQuotaService.java:50)
	at top.javarem.trigger.listener.RebateMessageCustomer.listener(RebateMessageCustomer.java:53)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:77)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:263)
	... 13 common frames omitted
Caused by: java.lang.Throwable: 活动库存为空
	at top.javarem.types.exception.AppException.<init>(AppException.java:30)
	... 24 common frames omitted
25-01-13.16:28:46.514 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"70729864269","timestamp":"Jan 13, 2025 4:25:42 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_20250104"}}
25-01-13.16:28:46.627 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=0) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.16:28:46.627 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.16:28:46.627 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] WARN  ConditionalRejectingErrorHandler - Execution of Rabbit message listener failed.
org.springframework.amqp.rabbit.support.ListenerExecutionFailedException: Listener method 'public void top.javarem.trigger.listener.RebateMessageCustomer.listener(java.lang.String)' threw exception
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:272)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:209)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:148)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1674)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1593)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1581)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1572)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1516)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:1001)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:948)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:86)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1326)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1232)
	at java.lang.Thread.run(Thread.java:748)
Caused by: top.javarem.types.exception.AppException: null
	at top.javarem.domain.activity.service.quota.rule.impl.BaseFilterChain.execute(BaseFilterChain.java:36)
	at top.javarem.domain.activity.service.quota.AbstractRaffleActivityAccountQuotaService.createOrder(AbstractRaffleActivityAccountQuotaService.java:50)
	at top.javarem.trigger.listener.RebateMessageCustomer.listener(RebateMessageCustomer.java:53)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:77)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:263)
	... 13 common frames omitted
Caused by: java.lang.Throwable: 活动库存为空
	at top.javarem.types.exception.AppException.<init>(AppException.java:30)
	... 24 common frames omitted
25-01-13.16:28:46.642 [main            ] ERROR BehaviorRebateRepository - 写入返利记录，唯一索引冲突 userId: rem
org.springframework.dao.DuplicateKeyException: 
### Error updating database.  Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry 'rem_sku_20250104' for key 'user_behavior_rebate_order.uq_biz_id'
### The error may exist in top/javarem/infrastructure/dao/mapper/UserBehaviorRebateOrderMapper.java (best guess)
### The error may involve top.javarem.infrastructure.dao.mapper.UserBehaviorRebateOrderMapper.insert-Inline
### The error occurred while setting parameters
### SQL: INSERT INTO user_behavior_rebate_order  ( user_id, order_id, behavior_type, rebate_desc, rebate_type, rebate_config, biz_id )  VALUES (  ?, ?, ?, ?, ?, ?, ?  )
### Cause: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry 'rem_sku_20250104' for key 'user_behavior_rebate_order.uq_biz_id'
; Duplicate entry 'rem_sku_20250104' for key 'user_behavior_rebate_order.uq_biz_id'; nested exception is java.sql.SQLIntegrityConstraintViolationException: Duplicate entry 'rem_sku_20250104' for key 'user_behavior_rebate_order.uq_biz_id'
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:247)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:92)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:439)
	at com.sun.proxy.$Proxy96.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:272)
	at com.baomidou.mybatisplus.core.override.MybatisMapperMethod.execute(MybatisMapperMethod.java:59)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy$PlainMethodInvoker.invoke(MybatisMapperProxy.java:152)
	at com.baomidou.mybatisplus.core.override.MybatisMapperProxy.invoke(MybatisMapperProxy.java:89)
	at com.sun.proxy.$Proxy113.insert(Unknown Source)
	at com.baomidou.mybatisplus.extension.service.IService.save(IService.java:61)
	at com.baomidou.mybatisplus.extension.service.IService$$FastClassBySpringCGLIB$$f8525d18.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy.invokeMethod(CglibAopProxy.java:386)
	at org.springframework.aop.framework.CglibAopProxy.access$000(CglibAopProxy.java:85)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:704)
	at top.javarem.infrastructure.dao.iService.Impl.UserBehaviorRebateOrderServiceImpl$$EnhancerBySpringCGLIB$$e2465cc6.save(<generated>)
	at top.javarem.infrastructure.adapter.repository.BehaviorRebateRepository.lambda$saveUserRebateRecord$0(BehaviorRebateRepository.java:87)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at top.javarem.infrastructure.adapter.repository.BehaviorRebateRepository.saveUserRebateRecord(BehaviorRebateRepository.java:74)
	at top.javarem.infrastructure.adapter.repository.BehaviorRebateRepository$$FastClassBySpringCGLIB$$1bd3c4c8.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at top.javarem.infrastructure.adapter.repository.BehaviorRebateRepository$$EnhancerBySpringCGLIB$$d6b90400.saveUserRebateRecord(<generated>)
	at top.javarem.domain.rebate.service.BehaviorRebateService.createOrder(BehaviorRebateService.java:85)
	at top.javarem.rebate.RebateTest.test_createOrder(RebateTest.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:725)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:140)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:84)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$7(TestMethodTestDescriptor.java:214)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:210)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:135)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:66)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1255)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1255)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)
	at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:53)
	at com.intellij.junit5.JUnit5IdeaTestRunner.startRunnerWithArgs(JUnit5IdeaTestRunner.java:57)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater$1.execute(IdeaTestRunner.java:38)
	at com.intellij.rt.execution.junit.TestsRepeater.repeat(TestsRepeater.java:11)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:35)
	at com.intellij.rt.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:232)
	at com.intellij.rt.junit.JUnitStarter.main(JUnitStarter.java:55)
Caused by: java.sql.SQLIntegrityConstraintViolationException: Duplicate entry 'rem_sku_20250104' for key 'user_behavior_rebate_order.uq_biz_id'
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:117)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:58)
	at com.sun.proxy.$Proxy171.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:48)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:75)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:425)
	... 97 common frames omitted
25-01-13.16:28:46.642 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"70729864269","timestamp":"Jan 13, 2025 4:25:42 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_20250104"}}
25-01-13.16:28:46.737 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.16:28:46.768 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.16:28:46.768 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=0) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.16:28:46.768 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.16:28:46.768 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] WARN  ConditionalRejectingErrorHandler - Execution of Rabbit message listener failed.
org.springframework.amqp.rabbit.support.ListenerExecutionFailedException: Listener method 'public void top.javarem.trigger.listener.RebateMessageCustomer.listener(java.lang.String)' threw exception
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:272)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:209)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:148)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1674)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1593)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1581)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1572)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1516)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:1001)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:948)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:86)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1326)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1232)
	at java.lang.Thread.run(Thread.java:748)
Caused by: top.javarem.types.exception.AppException: null
	at top.javarem.domain.activity.service.quota.rule.impl.BaseFilterChain.execute(BaseFilterChain.java:36)
	at top.javarem.domain.activity.service.quota.AbstractRaffleActivityAccountQuotaService.createOrder(AbstractRaffleActivityAccountQuotaService.java:50)
	at top.javarem.trigger.listener.RebateMessageCustomer.listener(RebateMessageCustomer.java:53)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:77)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:263)
	... 13 common frames omitted
Caused by: java.lang.Throwable: 活动库存为空
	at top.javarem.types.exception.AppException.<init>(AppException.java:30)
	... 24 common frames omitted
25-01-13.16:28:46.784 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.16:28:46.799 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.16:28:47.526 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.16:28:47.777 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.16:28:47.777 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.16:28:47.777 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.16:28:47.777 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.16:28:47.811 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
25-01-13.16:28:47.998 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
25-01-13.16:29:23.965 [main            ] INFO  RebateTest             - Starting RebateTest using Java 1.8.0_151 on mile with PID 6624 (started by aaa in D:\Develop\project\rem-market\market-app)
25-01-13.16:29:23.981 [main            ] INFO  RebateTest             - The following 1 profile is active: "dev"
25-01-13.16:29:24.812 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-01-13.16:29:24.812 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-01-13.16:29:24.874 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 47 ms. Found 0 Redis repository interfaces.
25-01-13.16:29:26.267 [main            ] INFO  Version                - Redisson 3.26.0
25-01-13.16:29:27.033 [redisson-netty-1-6] INFO  ConnectionsHolder      - 1 connections initialized for 110.41.180.185/110.41.180.185:6379
25-01-13.16:29:27.217 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 110.41.180.185/110.41.180.185:6379
25-01-13.16:29:31.717 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-01-13.16:29:31.779 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [110.41.180.185:5672]
25-01-13.16:29:31.920 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#36525ab:0/SimpleConnection@6ad3fbe4 [delegate=amqp://lain@110.41.180.185:5672/, localPort= 52856]
25-01-13.16:29:32.287 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"70729864269","timestamp":"Jan 13, 2025 4:25:42 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_20250104"}}
25-01-13.16:29:32.417 [main            ] INFO  RebateTest             - Started RebateTest in 8.848 seconds (JVM running for 9.883)
25-01-13.16:29:32.448 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=0) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.16:29:32.448 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.16:29:32.448 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] WARN  ConditionalRejectingErrorHandler - Execution of Rabbit message listener failed.
org.springframework.amqp.rabbit.support.ListenerExecutionFailedException: Listener method 'public void top.javarem.trigger.listener.RebateMessageCustomer.listener(java.lang.String)' threw exception
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:272)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:209)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:148)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1674)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1593)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1581)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1572)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1516)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:1001)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:948)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:86)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1326)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1232)
	at java.lang.Thread.run(Thread.java:748)
Caused by: top.javarem.types.exception.AppException: null
	at top.javarem.domain.activity.service.quota.rule.impl.BaseFilterChain.execute(BaseFilterChain.java:36)
	at top.javarem.domain.activity.service.quota.AbstractRaffleActivityAccountQuotaService.createOrder(AbstractRaffleActivityAccountQuotaService.java:50)
	at top.javarem.trigger.listener.RebateMessageCustomer.listener(RebateMessageCustomer.java:53)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:77)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:263)
	... 13 common frames omitted
Caused by: java.lang.Throwable: 活动库存为空
	at top.javarem.types.exception.AppException.<init>(AppException.java:30)
	... 24 common frames omitted
25-01-13.16:29:32.480 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"70729864269","timestamp":"Jan 13, 2025 4:25:42 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_20250104"}}
25-01-13.16:29:32.576 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=0) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.16:29:32.576 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.16:29:32.576 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] WARN  ConditionalRejectingErrorHandler - Execution of Rabbit message listener failed.
org.springframework.amqp.rabbit.support.ListenerExecutionFailedException: Listener method 'public void top.javarem.trigger.listener.RebateMessageCustomer.listener(java.lang.String)' threw exception
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:272)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:209)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:148)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1674)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1593)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1581)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1572)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1516)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:1001)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:948)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:86)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1326)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1232)
	at java.lang.Thread.run(Thread.java:748)
Caused by: top.javarem.types.exception.AppException: null
	at top.javarem.domain.activity.service.quota.rule.impl.BaseFilterChain.execute(BaseFilterChain.java:36)
	at top.javarem.domain.activity.service.quota.AbstractRaffleActivityAccountQuotaService.createOrder(AbstractRaffleActivityAccountQuotaService.java:50)
	at top.javarem.trigger.listener.RebateMessageCustomer.listener(RebateMessageCustomer.java:53)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:77)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:263)
	... 13 common frames omitted
Caused by: java.lang.Throwable: 活动库存为空
	at top.javarem.types.exception.AppException.<init>(AppException.java:30)
	... 24 common frames omitted
25-01-13.16:29:32.607 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"70729864269","timestamp":"Jan 13, 2025 4:25:42 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_20250104"}}
25-01-13.16:29:32.672 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-01-13.16:29:32.703 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=0) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.16:29:32.703 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.16:29:32.703 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] WARN  ConditionalRejectingErrorHandler - Execution of Rabbit message listener failed.
org.springframework.amqp.rabbit.support.ListenerExecutionFailedException: Listener method 'public void top.javarem.trigger.listener.RebateMessageCustomer.listener(java.lang.String)' threw exception
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:272)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:209)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:148)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1674)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1593)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1581)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1572)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1516)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:1001)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:948)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:86)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1326)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1232)
	at java.lang.Thread.run(Thread.java:748)
Caused by: top.javarem.types.exception.AppException: null
	at top.javarem.domain.activity.service.quota.rule.impl.BaseFilterChain.execute(BaseFilterChain.java:36)
	at top.javarem.domain.activity.service.quota.AbstractRaffleActivityAccountQuotaService.createOrder(AbstractRaffleActivityAccountQuotaService.java:50)
	at top.javarem.trigger.listener.RebateMessageCustomer.listener(RebateMessageCustomer.java:53)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:77)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:263)
	... 13 common frames omitted
Caused by: java.lang.Throwable: 活动库存为空
	at top.javarem.types.exception.AppException.<init>(AppException.java:30)
	... 24 common frames omitted
25-01-13.16:29:32.734 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"70729864269","timestamp":"Jan 13, 2025 4:25:42 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_20250104"}}
25-01-13.16:29:32.833 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=0) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.16:29:32.833 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.16:29:32.833 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] WARN  ConditionalRejectingErrorHandler - Execution of Rabbit message listener failed.
org.springframework.amqp.rabbit.support.ListenerExecutionFailedException: Listener method 'public void top.javarem.trigger.listener.RebateMessageCustomer.listener(java.lang.String)' threw exception
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:272)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:209)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:148)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1674)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1593)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1581)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1572)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1516)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:1001)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:948)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:86)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1326)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1232)
	at java.lang.Thread.run(Thread.java:748)
Caused by: top.javarem.types.exception.AppException: null
	at top.javarem.domain.activity.service.quota.rule.impl.BaseFilterChain.execute(BaseFilterChain.java:36)
	at top.javarem.domain.activity.service.quota.AbstractRaffleActivityAccountQuotaService.createOrder(AbstractRaffleActivityAccountQuotaService.java:50)
	at top.javarem.trigger.listener.RebateMessageCustomer.listener(RebateMessageCustomer.java:53)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:77)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:263)
	... 13 common frames omitted
Caused by: java.lang.Throwable: 活动库存为空
	at top.javarem.types.exception.AppException.<init>(AppException.java:30)
	... 24 common frames omitted
25-01-13.16:29:32.848 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"70729864269","timestamp":"Jan 13, 2025 4:25:42 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_20250104"}}
25-01-13.16:29:32.958 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=0) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.16:29:32.958 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.16:29:32.958 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] WARN  ConditionalRejectingErrorHandler - Execution of Rabbit message listener failed.
org.springframework.amqp.rabbit.support.ListenerExecutionFailedException: Listener method 'public void top.javarem.trigger.listener.RebateMessageCustomer.listener(java.lang.String)' threw exception
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:272)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:209)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:148)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1674)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1593)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1581)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1572)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1516)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:1001)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:948)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:86)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1326)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1232)
	at java.lang.Thread.run(Thread.java:748)
Caused by: top.javarem.types.exception.AppException: null
	at top.javarem.domain.activity.service.quota.rule.impl.BaseFilterChain.execute(BaseFilterChain.java:36)
	at top.javarem.domain.activity.service.quota.AbstractRaffleActivityAccountQuotaService.createOrder(AbstractRaffleActivityAccountQuotaService.java:50)
	at top.javarem.trigger.listener.RebateMessageCustomer.listener(RebateMessageCustomer.java:53)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:77)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:263)
	... 13 common frames omitted
Caused by: java.lang.Throwable: 活动库存为空
	at top.javarem.types.exception.AppException.<init>(AppException.java:30)
	... 24 common frames omitted
25-01-13.16:29:32.973 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"70729864269","timestamp":"Jan 13, 2025 4:25:42 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_20250104"}}
25-01-13.16:29:33.071 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=0) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.16:29:33.087 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.16:29:33.088 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] WARN  ConditionalRejectingErrorHandler - Execution of Rabbit message listener failed.
org.springframework.amqp.rabbit.support.ListenerExecutionFailedException: Listener method 'public void top.javarem.trigger.listener.RebateMessageCustomer.listener(java.lang.String)' threw exception
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:272)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:209)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:148)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1674)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1593)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1581)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1572)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1516)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:1001)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:948)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:86)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1326)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1232)
	at java.lang.Thread.run(Thread.java:748)
Caused by: top.javarem.types.exception.AppException: null
	at top.javarem.domain.activity.service.quota.rule.impl.BaseFilterChain.execute(BaseFilterChain.java:36)
	at top.javarem.domain.activity.service.quota.AbstractRaffleActivityAccountQuotaService.createOrder(AbstractRaffleActivityAccountQuotaService.java:50)
	at top.javarem.trigger.listener.RebateMessageCustomer.listener(RebateMessageCustomer.java:53)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:77)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:263)
	... 13 common frames omitted
Caused by: java.lang.Throwable: 活动库存为空
	at top.javarem.types.exception.AppException.<init>(AppException.java:30)
	... 24 common frames omitted
25-01-13.16:29:33.113 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"70729864269","timestamp":"Jan 13, 2025 4:25:42 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_20250104"}}
25-01-13.16:29:33.134 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-01-13.16:29:33.202 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=0) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.16:29:33.202 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.16:29:33.202 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] WARN  ConditionalRejectingErrorHandler - Execution of Rabbit message listener failed.
org.springframework.amqp.rabbit.support.ListenerExecutionFailedException: Listener method 'public void top.javarem.trigger.listener.RebateMessageCustomer.listener(java.lang.String)' threw exception
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:272)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:209)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:148)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1674)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1593)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1581)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1572)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1516)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:1001)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:948)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:86)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1326)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1232)
	at java.lang.Thread.run(Thread.java:748)
Caused by: top.javarem.types.exception.AppException: null
	at top.javarem.domain.activity.service.quota.rule.impl.BaseFilterChain.execute(BaseFilterChain.java:36)
	at top.javarem.domain.activity.service.quota.AbstractRaffleActivityAccountQuotaService.createOrder(AbstractRaffleActivityAccountQuotaService.java:50)
	at top.javarem.trigger.listener.RebateMessageCustomer.listener(RebateMessageCustomer.java:53)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:77)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:263)
	... 13 common frames omitted
Caused by: java.lang.Throwable: 活动库存为空
	at top.javarem.types.exception.AppException.<init>(AppException.java:30)
	... 24 common frames omitted
25-01-13.16:29:33.233 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"70729864269","timestamp":"Jan 13, 2025 4:25:42 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_20250104"}}
25-01-13.16:29:33.327 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=0) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.16:29:33.327 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.16:29:33.327 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] WARN  ConditionalRejectingErrorHandler - Execution of Rabbit message listener failed.
org.springframework.amqp.rabbit.support.ListenerExecutionFailedException: Listener method 'public void top.javarem.trigger.listener.RebateMessageCustomer.listener(java.lang.String)' threw exception
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:272)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:209)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:148)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1674)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1593)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1581)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1572)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1516)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:1001)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:948)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:86)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1326)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1232)
	at java.lang.Thread.run(Thread.java:748)
Caused by: top.javarem.types.exception.AppException: null
	at top.javarem.domain.activity.service.quota.rule.impl.BaseFilterChain.execute(BaseFilterChain.java:36)
	at top.javarem.domain.activity.service.quota.AbstractRaffleActivityAccountQuotaService.createOrder(AbstractRaffleActivityAccountQuotaService.java:50)
	at top.javarem.trigger.listener.RebateMessageCustomer.listener(RebateMessageCustomer.java:53)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:77)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:263)
	... 13 common frames omitted
Caused by: java.lang.Throwable: 活动库存为空
	at top.javarem.types.exception.AppException.<init>(AppException.java:30)
	... 24 common frames omitted
25-01-13.16:29:33.358 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"70729864269","timestamp":"Jan 13, 2025 4:25:42 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_20250104"}}
25-01-13.16:29:33.452 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=0) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.16:29:33.452 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.16:29:33.452 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] WARN  ConditionalRejectingErrorHandler - Execution of Rabbit message listener failed.
org.springframework.amqp.rabbit.support.ListenerExecutionFailedException: Listener method 'public void top.javarem.trigger.listener.RebateMessageCustomer.listener(java.lang.String)' threw exception
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:272)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:209)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:148)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1674)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1593)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1581)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1572)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1516)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:1001)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:948)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:86)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1326)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1232)
	at java.lang.Thread.run(Thread.java:748)
Caused by: top.javarem.types.exception.AppException: null
	at top.javarem.domain.activity.service.quota.rule.impl.BaseFilterChain.execute(BaseFilterChain.java:36)
	at top.javarem.domain.activity.service.quota.AbstractRaffleActivityAccountQuotaService.createOrder(AbstractRaffleActivityAccountQuotaService.java:50)
	at top.javarem.trigger.listener.RebateMessageCustomer.listener(RebateMessageCustomer.java:53)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:77)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:263)
	... 13 common frames omitted
Caused by: java.lang.Throwable: 活动库存为空
	at top.javarem.types.exception.AppException.<init>(AppException.java:30)
	... 24 common frames omitted
25-01-13.16:29:33.471 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"70729864269","timestamp":"Jan 13, 2025 4:25:42 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_20250104"}}
25-01-13.16:29:33.534 [main            ] INFO  EventPublisher         - 发送MQ消息 topic: send_rebate message: BaseEvent.EventMessage(eventId=91882889239, timestamp=Mon Jan 13 16:29:33 CST 2025, data=SendRebateMessageEvent.RebateMessage(userId=rem, rebateDesc=签到返利-sku额度, rebateType=sku, rebateConfig=9011, bizId=rem_sku_20250106))
25-01-13.16:29:33.565 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=0) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.16:29:33.565 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.16:29:33.565 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] WARN  ConditionalRejectingErrorHandler - Execution of Rabbit message listener failed.
org.springframework.amqp.rabbit.support.ListenerExecutionFailedException: Listener method 'public void top.javarem.trigger.listener.RebateMessageCustomer.listener(java.lang.String)' threw exception
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:272)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:209)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:148)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1674)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1593)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1581)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1572)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1516)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:1001)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:948)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:86)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1326)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1232)
	at java.lang.Thread.run(Thread.java:748)
Caused by: top.javarem.types.exception.AppException: null
	at top.javarem.domain.activity.service.quota.rule.impl.BaseFilterChain.execute(BaseFilterChain.java:36)
	at top.javarem.domain.activity.service.quota.AbstractRaffleActivityAccountQuotaService.createOrder(AbstractRaffleActivityAccountQuotaService.java:50)
	at top.javarem.trigger.listener.RebateMessageCustomer.listener(RebateMessageCustomer.java:53)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:77)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:263)
	... 13 common frames omitted
Caused by: java.lang.Throwable: 活动库存为空
	at top.javarem.types.exception.AppException.<init>(AppException.java:30)
	... 24 common frames omitted
25-01-13.16:29:33.596 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"70729864269","timestamp":"Jan 13, 2025 4:25:42 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_20250104"}}
25-01-13.16:29:33.596 [main            ] INFO  EventPublisher         - 发送MQ消息 topic: send_rebate message: BaseEvent.EventMessage(eventId=08480591090, timestamp=Mon Jan 13 16:29:33 CST 2025, data=SendRebateMessageEvent.RebateMessage(userId=rem, rebateDesc=签到返利-积分, rebateType=integral, rebateConfig=10, bizId=rem_integral_20250106))
25-01-13.16:29:33.690 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=0) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.16:29:33.690 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.16:29:33.690 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] WARN  ConditionalRejectingErrorHandler - Execution of Rabbit message listener failed.
org.springframework.amqp.rabbit.support.ListenerExecutionFailedException: Listener method 'public void top.javarem.trigger.listener.RebateMessageCustomer.listener(java.lang.String)' threw exception
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:272)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:209)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:148)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1674)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1593)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1581)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1572)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1516)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:1001)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:948)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:86)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1326)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1232)
	at java.lang.Thread.run(Thread.java:748)
Caused by: top.javarem.types.exception.AppException: null
	at top.javarem.domain.activity.service.quota.rule.impl.BaseFilterChain.execute(BaseFilterChain.java:36)
	at top.javarem.domain.activity.service.quota.AbstractRaffleActivityAccountQuotaService.createOrder(AbstractRaffleActivityAccountQuotaService.java:50)
	at top.javarem.trigger.listener.RebateMessageCustomer.listener(RebateMessageCustomer.java:53)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:77)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:263)
	... 13 common frames omitted
Caused by: java.lang.Throwable: 活动库存为空
	at top.javarem.types.exception.AppException.<init>(AppException.java:30)
	... 24 common frames omitted
25-01-13.16:29:33.721 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"70729864269","timestamp":"Jan 13, 2025 4:25:42 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_20250104"}}
25-01-13.16:29:33.769 [main            ] INFO  RebateTest             - 请求参数：{"behaviorType":"SIGN","outBusinessNo":"20250106","userId":"rem"}
25-01-13.16:29:33.770 [main            ] INFO  RebateTest             - 测试结果：["rem_sku_20250106","rem_integral_20250106"]
25-01-13.16:29:33.802 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.16:29:33.817 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=0) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.16:29:33.817 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.16:29:33.817 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] WARN  ConditionalRejectingErrorHandler - Execution of Rabbit message listener failed.
org.springframework.amqp.rabbit.support.ListenerExecutionFailedException: Listener method 'public void top.javarem.trigger.listener.RebateMessageCustomer.listener(java.lang.String)' threw exception
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:272)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandlerAndProcessResult(MessagingMessageListenerAdapter.java:209)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.onMessage(MessagingMessageListenerAdapter.java:148)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:1674)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.actualInvokeListener(AbstractMessageListenerContainer.java:1593)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:1581)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:1572)
	at org.springframework.amqp.rabbit.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:1516)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.doReceiveAndExecute(SimpleMessageListenerContainer.java:1001)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.receiveAndExecute(SimpleMessageListenerContainer.java:948)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer.access$1600(SimpleMessageListenerContainer.java:86)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.mainLoop(SimpleMessageListenerContainer.java:1326)
	at org.springframework.amqp.rabbit.listener.SimpleMessageListenerContainer$AsyncMessageProcessingConsumer.run(SimpleMessageListenerContainer.java:1232)
	at java.lang.Thread.run(Thread.java:748)
Caused by: top.javarem.types.exception.AppException: null
	at top.javarem.domain.activity.service.quota.rule.impl.BaseFilterChain.execute(BaseFilterChain.java:36)
	at top.javarem.domain.activity.service.quota.AbstractRaffleActivityAccountQuotaService.createOrder(AbstractRaffleActivityAccountQuotaService.java:50)
	at top.javarem.trigger.listener.RebateMessageCustomer.listener(RebateMessageCustomer.java:53)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.amqp.rabbit.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:77)
	at org.springframework.amqp.rabbit.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:263)
	... 13 common frames omitted
Caused by: java.lang.Throwable: 活动库存为空
	at top.javarem.types.exception.AppException.<init>(AppException.java:30)
	... 24 common frames omitted
25-01-13.16:29:33.833 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.16:29:33.864 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.16:29:33.864 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.16:29:34.186 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.16:29:34.445 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.16:29:34.449 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.16:29:34.449 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.16:29:34.449 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.16:29:34.502 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
25-01-13.16:29:34.534 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
25-01-13.16:33:39.084 [main            ] INFO  RebateTest             - Starting RebateTest using Java 1.8.0_151 on mile with PID 18184 (started by aaa in D:\Develop\project\rem-market\market-app)
25-01-13.16:33:39.084 [main            ] INFO  RebateTest             - The following 1 profile is active: "dev"
25-01-13.16:33:39.953 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-01-13.16:33:39.956 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-01-13.16:33:40.013 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 48 ms. Found 0 Redis repository interfaces.
25-01-13.16:33:41.433 [main            ] INFO  Version                - Redisson 3.26.0
25-01-13.16:33:42.177 [redisson-netty-1-6] INFO  ConnectionsHolder      - 1 connections initialized for 110.41.180.185/110.41.180.185:6379
25-01-13.16:33:42.369 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 110.41.180.185/110.41.180.185:6379
25-01-13.16:33:47.236 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-01-13.16:33:47.311 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [110.41.180.185:5672]
25-01-13.16:33:47.464 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#39851c5:0/SimpleConnection@983050b [delegate=amqp://lain@110.41.180.185:5672/, localPort= 52967]
25-01-13.16:33:47.837 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"70729864269","timestamp":"Jan 13, 2025 4:25:42 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_20250104"}}
25-01-13.16:33:47.978 [main            ] INFO  RebateTest             - Started RebateTest in 9.292 seconds (JVM running for 10.335)
25-01-13.16:33:47.994 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=20) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.16:33:47.994 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.16:33:47.994 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SkuStockFilterChain    - 执行活动sku库存扣减责任链
25-01-13.16:33:48.057 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  ActivityRepository     - 活动剩余库存加锁失败 rem_market_activity_sku_stock_key_9011_19
25-01-13.16:33:48.057 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - CreateQuotaOrderAggregate(userId=rem, activityId=100301, activityName=null, totalCount=1, monthCount=1, dayCount=1, activityOrder=ActivityOrderEntity(userId=rem, sku=9011, activityId=100301, activityName=测试活动, strategyId=100006, orderId=57059196567, orderTime=2025-01-13T16:33:48.057, totalCount=1, dayCount=1, monthCount=1, status=completed, outBusinessNo=rem_sku_20250104))
25-01-13.16:33:48.057 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-01-13.16:33:48.667 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-01-13.16:33:49.108 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"96791092578","timestamp":"Jan 13, 2025 4:25:42 PM","data":{"userId":"rem","rebateDesc":"签到返利-积分","rebateType":"integral","rebateConfig":"10","bizId":"rem_integral_20250104"}}
25-01-13.16:33:49.108 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户行为返利消息 - 非sku奖励暂时不处理 topic: send_rebate message: {"eventId":"96791092578","timestamp":"Jan 13, 2025 4:25:42 PM","data":{"userId":"rem","rebateDesc":"签到返利-积分","rebateType":"integral","rebateConfig":"10","bizId":"rem_integral_20250104"}}
25-01-13.16:33:49.140 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"91882889239","timestamp":"Jan 13, 2025 4:29:33 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_20250106"}}
25-01-13.16:33:49.252 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=19) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.16:33:49.252 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.16:33:49.252 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SkuStockFilterChain    - 执行活动sku库存扣减责任链
25-01-13.16:33:49.283 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  ActivityRepository     - 活动剩余库存加锁失败 rem_market_activity_sku_stock_key_9011_18
25-01-13.16:33:49.299 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - CreateQuotaOrderAggregate(userId=rem, activityId=100301, activityName=null, totalCount=1, monthCount=1, dayCount=1, activityOrder=ActivityOrderEntity(userId=rem, sku=9011, activityId=100301, activityName=测试活动, strategyId=100006, orderId=25389151485, orderTime=2025-01-13T16:33:49.299, totalCount=1, dayCount=1, monthCount=1, status=completed, outBusinessNo=rem_sku_20250106))
25-01-13.16:33:49.299 [main            ] INFO  EventPublisher         - 发送MQ消息 topic: send_rebate message: BaseEvent.EventMessage(eventId=86109652344, timestamp=Mon Jan 13 16:33:48 CST 2025, data=SendRebateMessageEvent.RebateMessage(userId=rem, rebateDesc=签到返利-sku额度, rebateType=sku, rebateConfig=9011, bizId=rem_sku_20250107))
25-01-13.16:33:49.361 [main            ] INFO  EventPublisher         - 发送MQ消息 topic: send_rebate message: BaseEvent.EventMessage(eventId=90638666257, timestamp=Mon Jan 13 16:33:48 CST 2025, data=SendRebateMessageEvent.RebateMessage(userId=rem, rebateDesc=签到返利-积分, rebateType=integral, rebateConfig=10, bizId=rem_integral_20250107))
25-01-13.16:33:49.521 [main            ] INFO  RebateTest             - 请求参数：{"behaviorType":"SIGN","outBusinessNo":"20250107","userId":"rem"}
25-01-13.16:33:49.521 [main            ] INFO  RebateTest             - 测试结果：["rem_sku_20250107","rem_integral_20250107"]
25-01-13.16:33:49.567 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.16:33:49.599 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.16:33:49.615 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.16:33:49.677 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.16:33:49.740 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.16:33:50.021 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.16:33:50.024 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.16:33:50.025 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.16:33:50.025 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.16:33:50.088 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
25-01-13.16:33:50.153 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
25-01-13.16:34:12.721 [main            ] INFO  RebateTest             - Starting RebateTest using Java 1.8.0_151 on mile with PID 5896 (started by aaa in D:\Develop\project\rem-market\market-app)
25-01-13.16:34:12.721 [main            ] INFO  RebateTest             - The following 1 profile is active: "dev"
25-01-13.16:34:13.569 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-01-13.16:34:13.569 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-01-13.16:34:13.616 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 47 ms. Found 0 Redis repository interfaces.
25-01-13.16:34:15.041 [main            ] INFO  Version                - Redisson 3.26.0
25-01-13.16:34:15.795 [redisson-netty-1-6] INFO  ConnectionsHolder      - 1 connections initialized for 110.41.180.185/110.41.180.185:6379
25-01-13.16:34:15.990 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 110.41.180.185/110.41.180.185:6379
25-01-13.16:34:20.562 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-01-13.16:34:20.634 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [110.41.180.185:5672]
25-01-13.16:34:20.774 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#21280cbb:0/SimpleConnection@5f5923ef [delegate=amqp://lain@110.41.180.185:5672/, localPort= 53055]
25-01-13.16:34:21.122 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"08480591090","timestamp":"Jan 13, 2025 4:29:33 PM","data":{"userId":"rem","rebateDesc":"签到返利-积分","rebateType":"integral","rebateConfig":"10","bizId":"rem_integral_20250106"}}
25-01-13.16:34:21.130 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户行为返利消息 - 非sku奖励暂时不处理 topic: send_rebate message: {"eventId":"08480591090","timestamp":"Jan 13, 2025 4:29:33 PM","data":{"userId":"rem","rebateDesc":"签到返利-积分","rebateType":"integral","rebateConfig":"10","bizId":"rem_integral_20250106"}}
25-01-13.16:34:21.155 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"86109652344","timestamp":"Jan 13, 2025 4:33:48 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_20250107"}}
25-01-13.16:34:21.243 [main            ] INFO  RebateTest             - Started RebateTest in 8.925 seconds (JVM running for 10.033)
25-01-13.16:34:21.326 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=18) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.16:34:21.327 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.16:34:21.328 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SkuStockFilterChain    - 执行活动sku库存扣减责任链
25-01-13.16:34:21.378 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  ActivityRepository     - 活动剩余库存加锁失败 rem_market_activity_sku_stock_key_9011_17
25-01-13.16:34:21.381 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - CreateQuotaOrderAggregate(userId=rem, activityId=100301, activityName=null, totalCount=1, monthCount=1, dayCount=1, activityOrder=ActivityOrderEntity(userId=rem, sku=9011, activityId=100301, activityName=测试活动, strategyId=100006, orderId=43666714386, orderTime=2025-01-13T16:34:21.380, totalCount=1, dayCount=1, monthCount=1, status=completed, outBusinessNo=rem_sku_20250107))
25-01-13.16:34:21.386 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-01-13.16:34:21.902 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-01-13.16:34:22.279 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"90638666257","timestamp":"Jan 13, 2025 4:33:48 PM","data":{"userId":"rem","rebateDesc":"签到返利-积分","rebateType":"integral","rebateConfig":"10","bizId":"rem_integral_20250107"}}
25-01-13.16:34:22.280 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户行为返利消息 - 非sku奖励暂时不处理 topic: send_rebate message: {"eventId":"90638666257","timestamp":"Jan 13, 2025 4:33:48 PM","data":{"userId":"rem","rebateDesc":"签到返利-积分","rebateType":"integral","rebateConfig":"10","bizId":"rem_integral_20250107"}}
25-01-13.16:34:22.479 [main            ] INFO  EventPublisher         - 发送MQ消息 topic: send_rebate message: BaseEvent.EventMessage(eventId=73934710616, timestamp=Mon Jan 13 16:34:22 CST 2025, data=SendRebateMessageEvent.RebateMessage(userId=rem, rebateDesc=签到返利-sku额度, rebateType=sku, rebateConfig=9011, bizId=rem_sku_20250108))
25-01-13.16:34:22.501 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"73934710616","timestamp":"Jan 13, 2025 4:34:22 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_20250108"}}
25-01-13.16:34:22.532 [main            ] INFO  EventPublisher         - 发送MQ消息 topic: send_rebate message: BaseEvent.EventMessage(eventId=17894907342, timestamp=Mon Jan 13 16:34:22 CST 2025, data=SendRebateMessageEvent.RebateMessage(userId=rem, rebateDesc=签到返利-积分, rebateType=integral, rebateConfig=10, bizId=rem_integral_20250108))
25-01-13.16:34:22.607 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=17) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.16:34:22.607 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.16:34:22.607 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SkuStockFilterChain    - 执行活动sku库存扣减责任链
25-01-13.16:34:22.663 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  ActivityRepository     - 活动剩余库存加锁失败 rem_market_activity_sku_stock_key_9011_16
25-01-13.16:34:22.663 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - CreateQuotaOrderAggregate(userId=rem, activityId=100301, activityName=null, totalCount=1, monthCount=1, dayCount=1, activityOrder=ActivityOrderEntity(userId=rem, sku=9011, activityId=100301, activityName=测试活动, strategyId=100006, orderId=33026378514, orderTime=2025-01-13T16:34:22.663, totalCount=1, dayCount=1, monthCount=1, status=completed, outBusinessNo=rem_sku_20250108))
25-01-13.16:34:22.706 [main            ] INFO  RebateTest             - 请求参数：{"behaviorType":"SIGN","outBusinessNo":"20250108","userId":"rem"}
25-01-13.16:34:22.710 [main            ] INFO  RebateTest             - 测试结果：["rem_sku_20250108","rem_integral_20250108"]
25-01-13.16:34:22.748 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.16:34:22.770 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.16:34:22.791 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.16:34:22.971 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.16:34:23.032 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.16:34:23.266 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.16:34:23.269 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.16:34:23.270 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.16:34:23.270 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.16:34:23.322 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
25-01-13.16:34:23.368 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
25-01-13.16:39:22.220 [main            ] INFO  RebateTest             - Starting RebateTest using Java 1.8.0_151 on mile with PID 6940 (started by aaa in D:\Develop\project\rem-market\market-app)
25-01-13.16:39:22.220 [main            ] INFO  RebateTest             - The following 1 profile is active: "dev"
25-01-13.16:39:23.102 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
25-01-13.16:39:23.104 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
25-01-13.16:39:23.163 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 48 ms. Found 0 Redis repository interfaces.
25-01-13.16:39:24.582 [main            ] INFO  Version                - Redisson 3.26.0
25-01-13.16:39:25.352 [redisson-netty-1-6] INFO  ConnectionsHolder      - 1 connections initialized for 110.41.180.185/110.41.180.185:6379
25-01-13.16:39:25.551 [redisson-netty-1-13] INFO  ConnectionsHolder      - 5 connections initialized for 110.41.180.185/110.41.180.185:6379
25-01-13.16:39:30.319 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
25-01-13.16:39:30.382 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [110.41.180.185:5672]
25-01-13.16:39:30.556 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#27438750:0/SimpleConnection@17189618 [delegate=amqp://lain@110.41.180.185:5672/, localPort= 53161]
25-01-13.16:39:30.987 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"17894907342","timestamp":"Jan 13, 2025 4:34:22 PM","data":{"userId":"rem","rebateDesc":"签到返利-积分","rebateType":"integral","rebateConfig":"10","bizId":"rem_integral_20250108"}}
25-01-13.16:39:31.002 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户行为返利消息 - 非sku奖励暂时不处理 topic: send_rebate message: {"eventId":"17894907342","timestamp":"Jan 13, 2025 4:34:22 PM","data":{"userId":"rem","rebateDesc":"签到返利-积分","rebateType":"integral","rebateConfig":"10","bizId":"rem_integral_20250108"}}
25-01-13.16:39:31.159 [main            ] INFO  RebateTest             - Started RebateTest in 9.388 seconds (JVM running for 10.48)
25-01-13.16:39:31.397 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
25-01-13.16:39:31.887 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
25-01-13.16:39:32.315 [main            ] INFO  EventPublisher         - 发送MQ消息 topic: send_rebate message: BaseEvent.EventMessage(eventId=05288841066, timestamp=Mon Jan 13 16:39:31 CST 2025, data=SendRebateMessageEvent.RebateMessage(userId=rem, rebateDesc=签到返利-sku额度, rebateType=sku, rebateConfig=9011, bizId=rem_sku_20250109))
25-01-13.16:39:32.345 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  RebateMessageCustomer  - 监听用户返利消息 topic:send_rebate message:{"eventId":"05288841066","timestamp":"Jan 13, 2025 4:39:31 PM","data":{"userId":"rem","rebateDesc":"签到返利-sku额度","rebateType":"sku","rebateConfig":"9011","bizId":"rem_sku_20250109"}}
25-01-13.16:39:32.360 [main            ] INFO  EventPublisher         - 发送MQ消息 topic: send_rebate message: BaseEvent.EventMessage(eventId=32547576031, timestamp=Mon Jan 13 16:39:31 CST 2025, data=SendRebateMessageEvent.RebateMessage(userId=rem, rebateDesc=签到返利-积分, rebateType=integral, rebateConfig=10, bizId=rem_integral_20250109))
25-01-13.16:39:32.503 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - 查询结果：ActivitySkuEntity(sku=9011, activityId=100301, activityCountId=11101, stockCount=20, stockCountSurplus=16) ActivityEntity(activityId=100301, activityName=测试活动, activityDesc=测试活动, beginTime=Sat Mar 09 10:15:10 CST 2024, endTime=Thu Mar 09 10:15:10 CST 2034, strategyId=100006, status=open) ActivityCountEntity(activityCountId=11101, totalCount=1, dayCount=1, monthCount=1)
25-01-13.16:39:32.504 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  BaseFilterChain        - 执行基础规则责任链
25-01-13.16:39:32.505 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SkuStockFilterChain    - 执行活动sku库存扣减责任链
25-01-13.16:39:32.535 [main            ] INFO  RebateTest             - 请求参数：{"behaviorType":"SIGN","outBusinessNo":"20250109","userId":"rem"}
25-01-13.16:39:32.535 [main            ] INFO  RebateTest             - 测试结果：["rem_sku_20250109","rem_integral_20250109"]
25-01-13.16:39:32.551 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  ActivityRepository     - 活动剩余库存加锁失败 rem_market_activity_sku_stock_key_9011_15
25-01-13.16:39:32.551 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  AbstractRaffleActivityAccountQuotaService - CreateQuotaOrderAggregate(userId=rem, activityId=100301, activityName=null, totalCount=1, monthCount=1, dayCount=1, activityOrder=ActivityOrderEntity(userId=rem, sku=9011, activityId=100301, activityName=测试活动, strategyId=100006, orderId=26330247441, orderTime=2025-01-13T16:39:32.551, totalCount=1, dayCount=1, monthCount=1, status=completed, outBusinessNo=rem_sku_20250109))
25-01-13.16:39:32.582 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.16:39:32.614 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.16:39:32.645 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
25-01-13.16:39:32.887 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.16:39:32.887 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.16:39:33.172 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#2-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
25-01-13.16:39:33.187 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.16:39:33.187 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.16:39:33.187 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
25-01-13.16:39:33.250 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
25-01-13.16:39:33.426 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
